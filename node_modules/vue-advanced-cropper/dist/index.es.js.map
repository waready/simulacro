{"version":3,"file":"index.es.js","sources":["../node_modules/classnames/index.js","../node_modules/easy-bem/index.js","../node_modules/debounce/index.js","../node_modules/tslib/tslib.es6.js","../src/core/events.ts","../src/core/constants.ts","../src/core/service.ts","../src/core/algorithms/approximatedSize.ts","../src/core/utils.ts","../src/core/algorithms/move.ts","../src/core/algorithms/applyTransform.ts","../src/core/algorithms/areaRestrictions.ts","../src/core/algorithms/autoZoom.ts","../src/core/algorithms/defaultBoundaries.ts","../src/core/algorithms/defaultPosition.ts","../src/core/algorithms/defaultSize.ts","../src/core/algorithms/defaultVisibleArea.ts","../src/core/algorithms/fitCoordinates.ts","../src/core/algorithms/initStretcher.ts","../src/core/algorithms/limitBy.ts","../src/core/algorithms/manipulateImage.ts","../src/core/algorithms/rotateImage.ts","../src/core/algorithms/flipImage.ts","../src/core/algorithms/normalizeEvent.ts","../src/core/algorithms/sizeRestrictions.ts","../src/core/algorithms/positionRestrictions.ts","../src/core/algorithms/refineSizeRestrictions.ts","../src/core/algorithms/refineVisibleArea.ts","../src/core/algorithms/resize.ts","../src/core/algorithms/roundCoordinates.ts","../src/core/algorithms/fitVisibleArea.ts","../src/core/algorithms/stencil.ts","../src/mixins/draggable.js","../node_modules/rollup-plugin-vue/node_modules/vue-runtime-helpers/dist/normalize-component.mjs","../src/core/canvas.ts","../src/core/image.ts","../src/core/touch.ts","../src/index.js"],"sourcesContent":["/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg) && arg.length) {\n\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\tif (inner) {\n\t\t\t\t\tclasses.push(inner);\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","'use strict';\r\n\r\n/**\r\n * BEM class name factory.\r\n *\r\n * @typedef {Function} Bem\r\n * @param {String|Object} [elementOrMods] Element name or hash object with mods\r\n * @param {Object} [mods] Hash object with mods\r\n * @returns {String}\r\n */\r\n\r\n/**\r\n * Returns BEM class name factory.\r\n *\r\n * @param {String} componentName Block name\r\n * @returns {Bem}\r\n */\r\nmodule.exports = function bem(componentName) {\r\n    return function (elementOrMods, mods) {\r\n        if (!elementOrMods) {\r\n            return componentName;\r\n        }\r\n\r\n        var element;\r\n\r\n        if (typeof elementOrMods === 'string') {\r\n            element = elementOrMods;\r\n        } else {\r\n            mods = elementOrMods;\r\n        }\r\n\r\n        var base = componentName;\r\n        if (element) {\r\n            base += '__' + element;\r\n        }\r\n\r\n        return base + (\r\n            mods\r\n                ? Object.keys(mods).reduce(function (result, name) {\r\n                    var value = mods[name];\r\n\r\n                    if (value) {\r\n                        result += ' ' + (\r\n                            typeof value === 'boolean'\r\n                                ? (base + '--' + name)\r\n                                : (base + '--' + name + '_' + value)\r\n                        );\r\n                    }\r\n\r\n                    return result;\r\n                }, '')\r\n                : ''\r\n        );\r\n    };\r\n}\r\n","/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear' \n * that is a function which will clear the timer to prevent previously scheduled executions. \n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\nfunction debounce(func, wait, immediate){\n  var timeout, args, context, timestamp, result;\n  if (null == wait) wait = 100;\n\n  function later() {\n    var last = Date.now() - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    }\n  };\n\n  var debounced = function(){\n    context = this;\n    args = arguments;\n    timestamp = Date.now();\n    var callNow = immediate && !timeout;\n    if (!timeout) timeout = setTimeout(later, wait);\n    if (callNow) {\n      result = func.apply(context, args);\n      context = args = null;\n    }\n\n    return result;\n  };\n\n  debounced.clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n  \n  debounced.flush = function() {\n    if (timeout) {\n      result = func.apply(context, args);\n      context = args = null;\n      \n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n\n  return debounced;\n};\n\n// Adds compatibility for ES modules\ndebounce.debounce = debounce;\n\nmodule.exports = debounce;\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { StencilEvent, Diff, MoveDirections, Point, ResizeDirections, Scale } from './typings';\r\n\r\nexport class ManipulateImageEvent implements StencilEvent {\r\n\ttype: 'manipulateImage';\r\n\tnativeEvent: Event;\r\n\tmove: Partial<MoveDirections>;\r\n\tscale: Partial<Scale>;\r\n\tconstructor(move: Partial<MoveDirections> = {}, scale: Partial<Scale> = {}) {\r\n\t\tthis.type = 'manipulateImage';\r\n\t\tthis.move = move;\r\n\t\tthis.scale = scale;\r\n\t}\r\n}\r\n\r\nexport interface ResizeEventParams {\r\n\tcompensate?: boolean;\r\n\tpreserveRatio?: boolean;\r\n\tallowedDirections?: ResizeDirections;\r\n\trespectDirection?: 'width' | 'height';\r\n}\r\n\r\nexport class ResizeEvent implements StencilEvent {\r\n\ttype: 'resize';\r\n\tdirections: ResizeDirections;\r\n\tparams: ResizeEventParams;\r\n\r\n\tconstructor(directions: ResizeDirections, params: ResizeEventParams = {}) {\r\n\t\tthis.type = 'resize';\r\n\t\tthis.directions = directions;\r\n\t\tthis.params = params;\r\n\t}\r\n}\r\n\r\nexport class MoveEvent implements StencilEvent {\r\n\ttype: 'move';\r\n\tdirections: MoveDirections;\r\n\r\n\tconstructor(directions: MoveDirections) {\r\n\t\tthis.type = 'move';\r\n\t\tthis.directions = directions;\r\n\t}\r\n}\r\n\r\nexport class DragEvent implements StencilEvent {\r\n\ttype: 'drag';\r\n\tnativeEvent: Event;\r\n\tposition: Point;\r\n\tpreviousPosition: Point;\r\n\tanchor: Point;\r\n\telement: HTMLElement;\r\n\r\n\tconstructor(nativeEvent: Event, element: HTMLElement, position: Point, previousPosition: Point, anchor: Point) {\r\n\t\tthis.type = 'drag';\r\n\t\tthis.nativeEvent = nativeEvent;\r\n\t\tthis.position = position;\r\n\t\tthis.previousPosition = previousPosition;\r\n\t\tthis.element = element;\r\n\t\tthis.anchor = anchor;\r\n\t}\r\n\tpublic shift(): Diff {\r\n\t\tconst { element, anchor, position } = this;\r\n\t\tconst { left, top } = element.getBoundingClientRect();\r\n\r\n\t\treturn {\r\n\t\t\tleft: position.left - left - anchor.left,\r\n\t\t\ttop: position.top - top - anchor.top,\r\n\t\t};\r\n\t}\r\n}\r\n","import { HorizontalDirection, PositionDirection, VerticalDirection, MainDirections } from './typings';\r\n\r\nexport const ALL_DIRECTIONS: PositionDirection[] = ['left', 'right', 'top', 'bottom'];\r\nexport const HORIZONTAL_DIRECTIONS: HorizontalDirection[] = ['left', 'right'];\r\nexport const VERTICAL_DIRECTIONS: VerticalDirection[] = ['top', 'bottom'];\r\nexport const MAIN_DIRECTIONS: MainDirections[] = ['left', 'top'];\r\nexport const IMAGE_RESTRICTIONS = ['fill-area', 'fit-area', 'stencil', 'none'];\r\nexport const XHR_DONE = 4;\r\n\r\nexport const DEFAULT_COORDINATES = {\r\n\tleft: 0,\r\n\ttop: 0,\r\n\twidth: 0,\r\n\theight: 0,\r\n};\r\n","import {\r\n\tAspectRatio,\r\n\tCoordinates,\r\n\tDiff,\r\n\tIntersections,\r\n\tLimits,\r\n\tMoveDirections,\r\n\tPoint,\r\n\tResizeDirections,\r\n\tSize,\r\n\tSizeRestrictions,\r\n} from './typings';\r\nimport { ALL_DIRECTIONS } from './constants';\r\n\r\nexport function isEqual(a: any, b: any, properties?: string[]): boolean {\r\n\tproperties = properties || ['width', 'height', 'left', 'top'];\r\n\treturn !properties.some((property) => a[property] !== b[property]);\r\n}\r\n\r\nexport function toLimits(object: Coordinates): Limits {\r\n\treturn {\r\n\t\tleft: object.left,\r\n\t\ttop: object.top,\r\n\t\tright: object.left + object.width,\r\n\t\tbottom: object.top + object.height,\r\n\t};\r\n}\r\n\r\nexport function diff(firstObject: Point, secondObject: Point): Diff {\r\n\treturn {\r\n\t\tleft: firstObject.left - secondObject.left,\r\n\t\ttop: firstObject.top - secondObject.top,\r\n\t};\r\n}\r\n\r\nexport function getCenter(object: Coordinates): Point {\r\n\treturn {\r\n\t\tleft: object.left + object.width / 2,\r\n\t\ttop: object.top + object.height / 2,\r\n\t};\r\n}\r\n\r\nexport function getIntersections(object: Coordinates, limits: Limits): Intersections {\r\n\tconst intersections: Intersections = {\r\n\t\tleft: 0,\r\n\t\ttop: 0,\r\n\t\tright: 0,\r\n\t\tbottom: 0,\r\n\t};\r\n\tALL_DIRECTIONS.forEach((direction) => {\r\n\t\tconst areaLimit = limits[direction];\r\n\t\tconst objectLimit = toLimits(object)[direction];\r\n\t\tif (areaLimit !== undefined && objectLimit !== undefined) {\r\n\t\t\tif (direction === 'left' || direction === 'top') {\r\n\t\t\t\tintersections[direction] = Math.max(0, areaLimit - objectLimit);\r\n\t\t\t} else {\r\n\t\t\t\tintersections[direction] = Math.max(0, objectLimit - areaLimit);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tintersections[direction] = 0;\r\n\t\t}\r\n\t});\r\n\treturn intersections;\r\n}\r\n\r\nexport function applyDirections(coordinates: Coordinates, directions: ResizeDirections): Coordinates {\r\n\treturn {\r\n\t\tleft: coordinates.left - directions.left,\r\n\t\ttop: coordinates.top - directions.top,\r\n\t\twidth: coordinates.width + directions.left + directions.right,\r\n\t\theight: coordinates.height + directions.top + directions.bottom,\r\n\t};\r\n}\r\n\r\nexport function inverseMove(directions: MoveDirections): MoveDirections {\r\n\treturn {\r\n\t\tleft: -directions.left,\r\n\t\ttop: -directions.top,\r\n\t};\r\n}\r\n\r\nexport function applyMove(object: Coordinates, move: MoveDirections): Coordinates {\r\n\treturn {\r\n\t\t...object,\r\n\t\tleft: object.left + move.left,\r\n\t\ttop: object.top + move.top,\r\n\t};\r\n}\r\n\r\nexport function applyScale(object: Coordinates, scaleFactor: number, center?: Point, progress?: number): Coordinates {\r\n\tif (scaleFactor !== 1) {\r\n\t\tif (center) {\r\n\t\t\tconst currentCenter = getCenter(object);\r\n\t\t\treturn {\r\n\t\t\t\twidth: object.width * scaleFactor,\r\n\t\t\t\theight: object.height * scaleFactor,\r\n\t\t\t\tleft:\r\n\t\t\t\t\tobject.left +\r\n\t\t\t\t\t(object.width * (1 - scaleFactor)) / 2 +\r\n\t\t\t\t\t(center.left - currentCenter.left) * (progress || 1 - scaleFactor),\r\n\t\t\t\ttop:\r\n\t\t\t\t\tobject.top +\r\n\t\t\t\t\t(object.height * (1 - scaleFactor)) / 2 +\r\n\t\t\t\t\t(center.top - currentCenter.top) * (progress || 1 - scaleFactor),\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\treturn {\r\n\t\t\t\twidth: object.width * scaleFactor,\r\n\t\t\t\theight: object.height * scaleFactor,\r\n\t\t\t\tleft: object.left + (object.width * (1 - scaleFactor)) / 2,\r\n\t\t\t\ttop: object.top + (object.height * (1 - scaleFactor)) / 2,\r\n\t\t\t};\r\n\t\t}\r\n\t} else {\r\n\t\treturn object;\r\n\t}\r\n}\r\n\r\nexport function ratio(object: Size): number {\r\n\treturn object.width / object.height;\r\n}\r\n\r\nexport function maxScale(object: Coordinates, area: Limits): number {\r\n\treturn Math.min(\r\n\t\tarea.right !== undefined && area.left !== undefined ? (area.right - area.left) / object.width : Infinity,\r\n\t\tarea.bottom !== undefined && area.top !== undefined ? (area.bottom - area.top) / object.height : Infinity,\r\n\t);\r\n}\r\n\r\n// Move object to correspond limits\r\nexport function fit(object: Coordinates, limits: Limits): MoveDirections {\r\n\tconst directions = {\r\n\t\tleft: 0,\r\n\t\ttop: 0,\r\n\t};\r\n\r\n\tconst intersection = getIntersections(object, limits);\r\n\r\n\tif (intersection.left && intersection.left > 0) {\r\n\t\tdirections.left = intersection.left;\r\n\t} else if (intersection.right && intersection.right > 0) {\r\n\t\tdirections.left = -intersection.right;\r\n\t}\r\n\tif (intersection.top && intersection.top > 0) {\r\n\t\tdirections.top = intersection.top;\r\n\t} else if (intersection.bottom && intersection.bottom > 0) {\r\n\t\tdirections.top = -intersection.bottom;\r\n\t}\r\n\r\n\treturn directions;\r\n}\r\n\r\nexport function getBrokenRatio(currentAspectRatio: number, aspectRatio: AspectRatio): number | undefined {\r\n\tlet ratioBroken;\r\n\tif (aspectRatio.minimum && currentAspectRatio < aspectRatio.minimum) {\r\n\t\tratioBroken = aspectRatio.minimum;\r\n\t} else if (aspectRatio.maximum && currentAspectRatio > aspectRatio.maximum) {\r\n\t\tratioBroken = aspectRatio.maximum;\r\n\t}\r\n\treturn ratioBroken;\r\n}\r\n\r\nexport function fitSize(firstSize: Size, secondSize: Size): Size {\r\n\tconst firstRatio = ratio(firstSize);\r\n\tconst secondRatio = ratio(secondSize);\r\n\r\n\tif (secondSize.width < Infinity && secondSize.height < Infinity) {\r\n\t\tif (firstRatio > secondRatio) {\r\n\t\t\treturn {\r\n\t\t\t\twidth: secondSize.width,\r\n\t\t\t\theight: secondSize.width / firstRatio,\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\treturn {\r\n\t\t\t\twidth: secondSize.height * firstRatio,\r\n\t\t\t\theight: secondSize.height,\r\n\t\t\t};\r\n\t\t}\r\n\t} else if (secondSize.width < Infinity) {\r\n\t\treturn {\r\n\t\t\twidth: secondSize.width,\r\n\t\t\theight: secondSize.width / firstRatio,\r\n\t\t};\r\n\t} else if (secondSize.height < Infinity) {\r\n\t\treturn {\r\n\t\t\twidth: secondSize.height * firstRatio,\r\n\t\t\theight: secondSize.height,\r\n\t\t};\r\n\t} else {\r\n\t\treturn firstSize;\r\n\t}\r\n}\r\n\r\nexport function rotateSize(size: Size, angle: number) {\r\n\tconst radians = (angle * Math.PI) / 180;\r\n\treturn {\r\n\t\twidth: Math.abs(size.width * Math.cos(radians)) + Math.abs(size.height * Math.sin(radians)),\r\n\t\theight: Math.abs(size.width * Math.sin(radians)) + Math.abs(size.height * Math.cos(radians)),\r\n\t};\r\n}\r\n\r\nexport function rotatePoint(point: Point, angle: number) {\r\n\tconst radians = (angle * Math.PI) / 180;\r\n\treturn {\r\n\t\tleft: point.left * Math.cos(radians) - point.top * Math.sin(radians),\r\n\t\ttop: point.left * Math.sin(radians) + point.top * Math.cos(radians),\r\n\t};\r\n}\r\n\r\nexport function adjustSize(coordinates: Coordinates, area: Limits) {\r\n\tconst intersections = getIntersections(fitToLimits(coordinates, area), area);\r\n\r\n\tif (intersections.left + intersections.right + intersections.top + intersections.bottom) {\r\n\t\tif (intersections.left + intersections.right > intersections.top + intersections.bottom) {\r\n\t\t\treturn Math.min(\r\n\t\t\t\t(coordinates.width + intersections.left + intersections.right) / coordinates.width,\r\n\t\t\t\tmaxScale(coordinates, area),\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\treturn Math.min(\r\n\t\t\t\t(coordinates.height + intersections.top + intersections.bottom) / coordinates.height,\r\n\t\t\t\tmaxScale(coordinates, area),\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\treturn 1;\r\n}\r\n\r\nexport function fitToLimits(coordinates: Coordinates, area: Limits, inverse = false) {\r\n\tconst move = fit(coordinates, area);\r\n\treturn applyMove(coordinates, inverse ? inverseMove(move) : move);\r\n}\r\n\r\nexport function limitsToSize(area: Limits) {\r\n\treturn {\r\n\t\twidth: area.right !== undefined && area.left !== undefined ? area.right - area.left : Infinity,\r\n\t\theight: area.bottom !== undefined && area.top !== undefined ? area.bottom - area.top : Infinity,\r\n\t};\r\n}\r\n\r\nexport function limitSizeRestrictions(sizeRestrictions: SizeRestrictions, object: Size) {\r\n\treturn {\r\n\t\t...sizeRestrictions,\r\n\t\tminWidth: Math.min(object.width, sizeRestrictions.minWidth),\r\n\t\tminHeight: Math.min(object.height, sizeRestrictions.minHeight),\r\n\t\tmaxWidth: Math.min(object.width, sizeRestrictions.maxWidth),\r\n\t\tmaxHeight: Math.min(object.height, sizeRestrictions.maxHeight),\r\n\t};\r\n}\r\n\r\nexport function joinLimits(a: Limits, b: Limits, intersection = true): Limits {\r\n\tconst limits: Limits = {};\r\n\tALL_DIRECTIONS.forEach((direction) => {\r\n\t\tconst firstDirection = a[direction];\r\n\t\tconst secondDirection = b[direction];\r\n\t\tif (firstDirection !== undefined && secondDirection !== undefined) {\r\n\t\t\tif (direction === 'left' || direction === 'top') {\r\n\t\t\t\tlimits[direction] = intersection\r\n\t\t\t\t\t? Math.max(firstDirection, secondDirection)\r\n\t\t\t\t\t: Math.min(firstDirection, secondDirection);\r\n\t\t\t} else {\r\n\t\t\t\tlimits[direction] = intersection\r\n\t\t\t\t\t? Math.min(firstDirection, secondDirection)\r\n\t\t\t\t\t: Math.max(firstDirection, secondDirection);\r\n\t\t\t}\r\n\t\t} else if (secondDirection !== undefined) {\r\n\t\t\tlimits[direction] = secondDirection;\r\n\t\t} else if (firstDirection !== undefined) {\r\n\t\t\tlimits[direction] = firstDirection;\r\n\t\t}\r\n\t});\r\n\treturn limits;\r\n}\r\n\r\nexport function unionLimits(a: Limits, b: Limits) {\r\n\treturn joinLimits(a, b, false);\r\n}\r\n\r\nexport function intersectionLimits(a: Limits, b: Limits) {\r\n\treturn joinLimits(a, b, true);\r\n}\r\n","// This function returns the approximation size to width / height with respect to\r\n// restrictions and aspect ratio\r\nimport { AspectRatio, Size, SizeRestrictions } from '../typings';\r\nimport { ratio } from '../service';\r\n\r\ninterface CandidateSize extends Size {\r\n\t// Additional param to prevent double precision problems\r\n\tcorrectRatio?: boolean;\r\n}\r\n\r\ninterface ValidateSizeParams {\r\n\tsize: CandidateSize;\r\n\taspectRatio: AspectRatio;\r\n\tsizeRestrictions: SizeRestrictions;\r\n\tignoreMinimum?: boolean;\r\n}\r\nfunction validateSize(params: ValidateSizeParams): boolean {\r\n\tconst { size, aspectRatio, ignoreMinimum, sizeRestrictions } = params;\r\n\treturn Boolean(\r\n\t\t(size.correctRatio || (ratio(size) >= aspectRatio.minimum && ratio(size) <= aspectRatio.maximum)) &&\r\n\t\t\tsize.height <= sizeRestrictions.maxHeight &&\r\n\t\t\tsize.width <= sizeRestrictions.maxWidth &&\r\n\t\t\tsize.width &&\r\n\t\t\tsize.height &&\r\n\t\t\t(ignoreMinimum || (size.height >= sizeRestrictions.minHeight && size.width >= sizeRestrictions.minWidth)),\r\n\t);\r\n}\r\n\r\nfunction distance(a: Size, b: Size): number {\r\n\treturn Math.pow(a.width - b.width, 2) + Math.pow(a.height - b.height, 2);\r\n}\r\n\r\n// Limitations:\r\n// 1. Assume that maximum width and height always larger than minimum width and height\r\n// 2. Assume that aspectRatio.minimum < aspectRatio.maximum\r\n// If you break this limitations function could return null!\r\ninterface ApproximatedSizeParams {\r\n\twidth: number;\r\n\theight: number;\r\n\tsizeRestrictions: SizeRestrictions;\r\n\taspectRatio?: AspectRatio;\r\n}\r\nexport function approximatedSize(params: ApproximatedSizeParams): Size {\r\n\tconst { width, height, sizeRestrictions } = params;\r\n\r\n\tconst aspectRatio = {\r\n\t\tminimum: (params.aspectRatio && params.aspectRatio.minimum) || 0,\r\n\t\tmaximum: (params.aspectRatio && params.aspectRatio.maximum) || Infinity,\r\n\t};\r\n\r\n\tconst coordinates = {\r\n\t\twidth: Math.max(sizeRestrictions.minWidth, Math.min(sizeRestrictions.maxWidth, width)),\r\n\t\theight: Math.max(sizeRestrictions.minHeight, Math.min(sizeRestrictions.maxHeight, height)),\r\n\t};\r\n\r\n\tfunction findBestCandidate(candidates: CandidateSize[], ignoreMinimum = false): CandidateSize | null {\r\n\t\treturn candidates.reduce<CandidateSize | null>((minimum: CandidateSize | null, size: CandidateSize) => {\r\n\t\t\tif (validateSize({ size, aspectRatio, sizeRestrictions, ignoreMinimum })) {\r\n\t\t\t\treturn !minimum || distance(size, { width, height }) < distance(minimum, { width, height })\r\n\t\t\t\t\t? size\r\n\t\t\t\t\t: minimum;\r\n\t\t\t} else {\r\n\t\t\t\treturn minimum;\r\n\t\t\t}\r\n\t\t}, null);\r\n\t}\r\n\r\n\tconst candidates: CandidateSize[] = [];\r\n\r\n\tif (aspectRatio) {\r\n\t\t[aspectRatio.minimum, aspectRatio.maximum].forEach((ratio) => {\r\n\t\t\tif (ratio) {\r\n\t\t\t\tcandidates.push(\r\n\t\t\t\t\t{ width: coordinates.width, height: coordinates.width / ratio, correctRatio: true },\r\n\t\t\t\t\t{ width: coordinates.height * ratio, height: coordinates.height, correctRatio: true },\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tif (validateSize({ size: coordinates, aspectRatio, sizeRestrictions })) {\r\n\t\tcandidates.push(coordinates);\r\n\t}\r\n\r\n\tconst candidate = findBestCandidate(candidates) || findBestCandidate(candidates, true);\r\n\r\n\treturn (\r\n\t\tcandidate && {\r\n\t\t\twidth: candidate.width,\r\n\t\t\theight: candidate.height,\r\n\t\t}\r\n\t);\r\n}\r\n","type Protocol = 'http' | 'https';\r\n\r\nexport function directionNames(hDirection, vDirection) {\r\n\tlet name, classname;\r\n\tif (hDirection && vDirection) {\r\n\t\tname = `${hDirection}${vDirection[0].toUpperCase()}${vDirection.slice(1)}`;\r\n\t\tclassname = `${hDirection}-${vDirection}`;\r\n\t} else {\r\n\t\tname = hDirection || vDirection;\r\n\t\tclassname = hDirection || vDirection;\r\n\t}\r\n\treturn { name, classname };\r\n}\r\n\r\nexport function isLocal(url: string) {\r\n\treturn /^data:/.test(url) || /^blob:/.test(url);\r\n}\r\n\r\nexport function isCrossOriginURL(url: string) {\r\n\tif (isLocal(url)) {\r\n\t\treturn false;\r\n\t}\r\n\tconst pageLocation = window.location;\r\n\tconst URL_HOST_PATTERN = /(\\w+:)?(?:\\/\\/)([\\w.-]+)?(?::(\\d+))?\\/?/;\r\n\tconst urlMatch = URL_HOST_PATTERN.exec(url) || [];\r\n\tconst urlparts = {\r\n\t\tprotocol: urlMatch[1] || '',\r\n\t\thost: urlMatch[2] || '',\r\n\t\tport: urlMatch[3] || '',\r\n\t};\r\n\r\n\tconst defaultPort = (protocol: Protocol) => {\r\n\t\tif (protocol === 'http') {\r\n\t\t\treturn 80;\r\n\t\t} else {\r\n\t\t\treturn 433;\r\n\t\t}\r\n\t};\r\n\r\n\tconst portOf = (location: any) => {\r\n\t\treturn location.port || defaultPort((location.protocol || pageLocation.protocol) as Protocol);\r\n\t};\r\n\r\n\treturn !(\r\n\t\t(!urlparts.protocol && !urlparts.host && !urlparts.port) ||\r\n\t\tBoolean(\r\n\t\t\turlparts.protocol &&\r\n\t\t\t\turlparts.protocol == pageLocation.protocol &&\r\n\t\t\t\turlparts.host &&\r\n\t\t\t\turlparts.host == pageLocation.host &&\r\n\t\t\t\turlparts.host &&\r\n\t\t\t\tportOf(urlparts) == portOf(pageLocation),\r\n\t\t)\r\n\t);\r\n}\r\n\r\nexport function isFunction(obj: any) {\r\n\treturn !!(obj && obj.constructor && obj.call && obj.apply);\r\n}\r\n\r\nexport function isUndefined(obj: any): boolean {\r\n\treturn obj === undefined;\r\n}\r\n\r\nexport function isObject(obj) {\r\n\treturn typeof obj === 'object' && obj !== null;\r\n}\r\n\r\nexport function getOptions(options: any, defaultScheme: any, falseScheme: any) {\r\n\tconst result: any = {};\r\n\tif (isObject(options)) {\r\n\t\tObject.keys(defaultScheme).forEach((key) => {\r\n\t\t\tif (isUndefined(options[key])) {\r\n\t\t\t\tresult[key] = defaultScheme[key];\r\n\t\t\t} else if (isObject(defaultScheme[key])) {\r\n\t\t\t\tif (isObject(options[key])) {\r\n\t\t\t\t\tresult[key] = getOptions(options[key], defaultScheme[key], falseScheme[key]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult[key] = options[key] ? defaultScheme[key] : falseScheme[key];\r\n\t\t\t\t}\r\n\t\t\t} else if (defaultScheme[key] === true || defaultScheme[key] === false) {\r\n\t\t\t\tresult[key] = Boolean(options[key]);\r\n\t\t\t} else {\r\n\t\t\t\tresult[key] = options[key];\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn result;\r\n\t} else {\r\n\t\tif (options) {\r\n\t\t\treturn defaultScheme;\r\n\t\t} else {\r\n\t\t\treturn falseScheme;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function getSettings<T extends {}>(param, defaultParams?: T) {\r\n\tlet result = {\r\n\t\tenabled: Boolean(param),\r\n\t\t...defaultParams,\r\n\t};\r\n\tif (isObject(param)) {\r\n\t\tresult = { ...result, ...param };\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport function parseNumber(number) {\r\n\tconst parsedNumber = Number(number);\r\n\tif (Number.isNaN(parsedNumber)) {\r\n\t\treturn number;\r\n\t} else {\r\n\t\treturn parsedNumber;\r\n\t}\r\n}\r\n\r\nexport function replacedProp(value, oldName, currentName) {\r\n\tif (!isEmpty(value) && process.env.NODE_ENV !== 'production') {\r\n\t\tconsole.warn(`Warning: prop \"${oldName}\" is deprecated, use \"${currentName}\" instead. Value:`, value);\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nexport function isEmpty(obj) {\r\n\treturn (!obj || Object.keys(obj).length === 0) && typeof obj !== 'function';\r\n}\r\n\r\nexport function isObjectLike(value) {\r\n\treturn typeof value === 'object' && value !== null;\r\n}\r\n\r\nexport function isNumber(value) {\r\n\treturn (\r\n\t\ttypeof (value == 'number' || (isObjectLike(value) && toString.call(value) == '[object Number]')) &&\r\n\t\t!isNaN(value)\r\n\t);\r\n}\r\n\r\nexport function isNaN(value) {\r\n\treturn value !== value;\r\n}\r\n\r\nexport function isLoadedImage(image) {\r\n\treturn Boolean(image.naturalWidth);\r\n}\r\n\r\nexport function distance(firstPoint, secondPoint) {\r\n\treturn Math.sqrt(Math.pow(firstPoint.x - secondPoint.x, 2) + Math.pow(firstPoint.y - secondPoint.y, 2));\r\n}\r\n\r\nexport function isApproximatelyEqual(a: number, b: number, precision = 0.001) {\r\n\tif (a === 0 || b === 0) {\r\n\t\treturn Math.abs(b - a) < precision;\r\n\t} else {\r\n\t\treturn Math.abs(b / a) < 1 + precision && Math.abs(b / a) > 1 - precision;\r\n\t}\r\n}\r\n\r\nexport function sign(value) {\r\n\tconst number = +value;\r\n\tif (number === 0 || isNaN(number)) {\r\n\t\treturn number;\r\n\t}\r\n\treturn number > 0 ? 1 : -1;\r\n}\r\n\r\nexport function radians(angle: number) {\r\n\treturn (angle * Math.PI) / 180;\r\n}\r\n","import { MoveEvent } from '../events';\r\nimport { Coordinates, PositionRestrictions } from '../typings';\r\nimport { applyMove, fit } from '../service';\r\n\r\nexport interface MoveParams {\r\n\tevent: MoveEvent;\r\n\tcoordinates: Coordinates;\r\n\tpositionRestrictions: PositionRestrictions;\r\n}\r\n\r\nexport function move(params: MoveParams): Coordinates {\r\n\tconst { event, coordinates, positionRestrictions = {} } = params;\r\n\r\n\tconst movedCoordinates = applyMove(coordinates, event.directions);\r\n\r\n\treturn applyMove(movedCoordinates, fit(movedCoordinates, positionRestrictions));\r\n}\r\n","import { AspectRatio, PositionRestrictions, SizeRestrictions, Transform, Coordinates, Size } from '../typings';\r\nimport { MoveEvent } from '../events';\r\nimport { approximatedSize } from './approximatedSize';\r\nimport { isUndefined } from '../utils';\r\nimport { move } from './move';\r\n\r\ninterface ApplyTransformParams {\r\n\tcoordinates: Coordinates;\r\n\ttransform: Transform | Transform[];\r\n\tsizeRestrictions: SizeRestrictions;\r\n\tpositionRestrictions: PositionRestrictions;\r\n\timageSize: Size;\r\n\taspectRatio?: AspectRatio;\r\n}\r\n\r\nexport function applyTransform(params: ApplyTransformParams) {\r\n\tconst {\r\n\t\tcoordinates: initialCoordinates,\r\n\t\ttransform,\r\n\t\timageSize,\r\n\t\tsizeRestrictions,\r\n\t\tpositionRestrictions,\r\n\t\taspectRatio,\r\n\t} = params;\r\n\r\n\tconst moveAlgorithm = (prevCoordinates, newCoordinates) => {\r\n\t\treturn move({\r\n\t\t\tcoordinates: prevCoordinates,\r\n\t\t\tpositionRestrictions,\r\n\t\t\tevent: new MoveEvent({\r\n\t\t\t\tleft: newCoordinates.left - prevCoordinates.left,\r\n\t\t\t\ttop: newCoordinates.top - prevCoordinates.top,\r\n\t\t\t}),\r\n\t\t});\r\n\t};\r\n\r\n\tconst resizeAlgorithm = (prevCoordinates, newCoordinates) => {\r\n\t\tlet coordinates = {\r\n\t\t\t...prevCoordinates,\r\n\t\t\t...approximatedSize({\r\n\t\t\t\twidth: newCoordinates.width,\r\n\t\t\t\theight: newCoordinates.height,\r\n\t\t\t\tsizeRestrictions,\r\n\t\t\t\taspectRatio,\r\n\t\t\t}),\r\n\t\t\tleft: 0,\r\n\t\t\ttop: 0,\r\n\t\t};\r\n\r\n\t\treturn moveAlgorithm(coordinates, {\r\n\t\t\tleft: prevCoordinates.left,\r\n\t\t\ttop: prevCoordinates.top,\r\n\t\t});\r\n\t};\r\n\r\n\tlet coordinates = { ...initialCoordinates };\r\n\r\n\tconst transforms = Array.isArray(transform) ? transform : [transform];\r\n\r\n\ttransforms.forEach((transform) => {\r\n\t\tlet changes: Partial<Coordinates> = {};\r\n\t\tif (typeof transform === 'function') {\r\n\t\t\tchanges = transform({ ...coordinates }, imageSize);\r\n\t\t} else {\r\n\t\t\tchanges = transform;\r\n\t\t}\r\n\r\n\t\tif (!isUndefined(changes.width) || !isUndefined(changes.height)) {\r\n\t\t\tcoordinates = resizeAlgorithm(coordinates, { ...coordinates, ...changes });\r\n\t\t}\r\n\t\tif (!isUndefined(changes.left) || !isUndefined(changes.top)) {\r\n\t\t\tcoordinates = moveAlgorithm(coordinates, { ...coordinates, ...changes });\r\n\t\t}\r\n\t});\r\n\r\n\treturn coordinates;\r\n}\r\n","import { Boundaries, ImageRestriction, Limits, Size, VisibleArea } from '../typings';\r\nimport { ratio } from '../service';\r\n\r\nexport interface DynamicAreaRestrictionsParams {\r\n\timageRestriction: ImageRestriction;\r\n\timageSize: Size;\r\n\tboundaries: Boundaries;\r\n\tvisibleArea?: VisibleArea;\r\n\tcenter?: boolean;\r\n\ttype: 'resize' | 'move';\r\n}\r\nexport function dynamicAreaRestrictions(params: DynamicAreaRestrictionsParams): Limits {\r\n\tconst { visibleArea, boundaries, imageSize, imageRestriction, type } = params;\r\n\r\n\tlet limits: Limits = {};\r\n\r\n\tif (imageRestriction === 'fill-area' || imageRestriction === 'area') {\r\n\t\tlimits = {\r\n\t\t\tleft: 0,\r\n\t\t\ttop: 0,\r\n\t\t\tright: imageSize.width,\r\n\t\t\tbottom: imageSize.height,\r\n\t\t};\r\n\t} else if (imageRestriction === 'fit-area') {\r\n\t\tif (ratio(boundaries) > ratio(imageSize)) {\r\n\t\t\tlimits = {\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tbottom: imageSize.height,\r\n\t\t\t};\r\n\t\t\tif (visibleArea && type === 'move') {\r\n\t\t\t\tif (visibleArea.width > imageSize.width) {\r\n\t\t\t\t\tlimits.left = -(visibleArea.width - imageSize.width) / 2;\r\n\t\t\t\t\tlimits.right = imageSize.width - limits.left;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlimits.left = 0;\r\n\t\t\t\t\tlimits.right = imageSize.width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlimits = {\r\n\t\t\t\tleft: 0,\r\n\t\t\t\tright: imageSize.width,\r\n\t\t\t};\r\n\t\t\tif (visibleArea && type === 'move') {\r\n\t\t\t\tif (visibleArea.height > imageSize.height) {\r\n\t\t\t\t\tlimits.top = -(visibleArea.height - imageSize.height) / 2;\r\n\t\t\t\t\tlimits.bottom = imageSize.height - limits.top;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlimits.top = 0;\r\n\t\t\t\t\tlimits.bottom = imageSize.height;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn limits;\r\n}\r\n","import {\r\n\tadjustSize,\r\n\tapplyMove,\r\n\tapplyScale,\r\n\tdiff,\r\n\tfit,\r\n\tfitToLimits,\r\n\tgetCenter,\r\n\tintersectionLimits,\r\n\tinverseMove,\r\n\tmaxScale,\r\n\tratio,\r\n\ttoLimits,\r\n} from '../service';\r\nimport {\r\n\tAspectRatio,\r\n\tBoundaries,\r\n\tCoordinates,\r\n\tCropperEvent,\r\n\tGetAreaRestrictions,\r\n\tPositionRestrictions,\r\n\tSize,\r\n\tSizeRestrictions,\r\n\tVisibleArea,\r\n} from '../typings';\r\nimport { isApproximatelyEqual } from '../utils';\r\nimport { approximatedSize } from './approximatedSize';\r\nimport { ALL_DIRECTIONS } from '../constants';\r\n\r\ninterface AutoZoomResult {\r\n\tvisibleArea: VisibleArea;\r\n\tcoordinates: Coordinates;\r\n}\r\n\r\ninterface AutoZoomParams {\r\n\tevent: CropperEvent;\r\n\tcoordinates: Coordinates;\r\n\tstencilReference: Coordinates;\r\n\tvisibleArea: VisibleArea;\r\n\tboundaries: Boundaries;\r\n\taspectRatio: AspectRatio;\r\n\tstencilSize: Size;\r\n\tsizeRestrictions: SizeRestrictions;\r\n\tpositionRestrictions: PositionRestrictions;\r\n\tgetAreaRestrictions: GetAreaRestrictions;\r\n}\r\n\r\nexport function fixedStencilAutoZoom(params: AutoZoomParams): AutoZoomResult {\r\n\tconst {\r\n\t\tevent,\r\n\t\tgetAreaRestrictions,\r\n\t\tboundaries,\r\n\t\tcoordinates: originalCoordinates,\r\n\t\tvisibleArea: originalVisibleArea,\r\n\t\taspectRatio,\r\n\t\tstencilSize,\r\n\t\tsizeRestrictions,\r\n\t\tpositionRestrictions,\r\n\t\tstencilReference,\r\n\t} = params;\r\n\r\n\tlet coordinates = { ...originalCoordinates };\r\n\tlet visibleArea = { ...originalVisibleArea };\r\n\r\n\t// Checks that coordinates has the same ratio that coordinates:\r\n\tlet stencil = { ...stencilSize };\r\n\r\n\tif (!isApproximatelyEqual(ratio(stencil), ratio(coordinates))) {\r\n\t\tif (process.env.NODE_ENV !== 'production') {\r\n\t\t\tconsole.error(\r\n\t\t\t\t`[Adjusting stencil] The aspect ratio of coordinates is not equal to the aspect ratio of stencil (${ratio(\r\n\t\t\t\t\tcoordinates,\r\n\t\t\t\t)} != ${ratio(stencil)})! Coordinates will be changed`,\r\n\t\t\t);\r\n\t\t}\r\n\t\tcoordinates = {\r\n\t\t\t...coordinates,\r\n\t\t\t...approximatedSize({\r\n\t\t\t\tsizeRestrictions,\r\n\t\t\t\twidth: coordinates.width,\r\n\t\t\t\theight: coordinates.height,\r\n\t\t\t\taspectRatio: {\r\n\t\t\t\t\tminimum: ratio(stencil),\r\n\t\t\t\t\tmaximum: ratio(stencil),\r\n\t\t\t\t},\r\n\t\t\t}),\r\n\t\t};\r\n\t}\r\n\r\n\t// First of all try to resize visible area as much as possible:\r\n\tvisibleArea = applyScale(visibleArea, (coordinates.width * boundaries.width) / (visibleArea.width * stencil.width));\r\n\r\n\t// Check that visible area doesn't break the area restrictions:\r\n\tconst scale = adjustSize(visibleArea, getAreaRestrictions({ visibleArea, type: 'resize' }));\r\n\tif (scale !== 1) {\r\n\t\tvisibleArea = applyScale(visibleArea, scale);\r\n\t\tcoordinates = applyScale(coordinates, scale);\r\n\t}\r\n\r\n\tvisibleArea = applyMove(visibleArea, diff(getCenter(coordinates), getCenter(visibleArea)));\r\n\r\n\t// Center stencil in visible area:\r\n\tvisibleArea = fitToLimits(visibleArea, getAreaRestrictions({ visibleArea, type: 'move' }));\r\n\tcoordinates = fitToLimits(coordinates, intersectionLimits(toLimits(visibleArea), positionRestrictions));\r\n\r\n\treturn {\r\n\t\tcoordinates,\r\n\t\tvisibleArea,\r\n\t};\r\n}\r\n\r\nexport function hybridStencilAutoZoom(params: AutoZoomParams): AutoZoomResult {\r\n\tconst {\r\n\t\tevent,\r\n\t\tgetAreaRestrictions,\r\n\t\tboundaries,\r\n\t\tcoordinates: originalCoordinates,\r\n\t\tvisibleArea: originalVisibleArea,\r\n\t\taspectRatio,\r\n\t\tstencilSize,\r\n\t\tsizeRestrictions,\r\n\t\tpositionRestrictions,\r\n\t\tstencilReference,\r\n\t} = params;\r\n\r\n\tlet coordinates = { ...originalCoordinates };\r\n\tlet visibleArea = { ...originalVisibleArea };\r\n\r\n\tif (originalCoordinates && originalVisibleArea && event.type !== 'manipulateImage') {\r\n\t\t// Checks that coordinates has the same ratio that coordinates:\r\n\t\tlet stencil: Size = {\r\n\t\t\twidth: 0,\r\n\t\t\theight: 0,\r\n\t\t};\r\n\r\n\t\tconst coefficient = visibleArea.width / boundaries.width;\r\n\r\n\t\tif (ratio(boundaries) > ratio(coordinates)) {\r\n\t\t\tstencil.height = boundaries.height * 0.8;\r\n\t\t\tstencil.width = stencil.height * ratio(coordinates);\r\n\t\t} else {\r\n\t\t\tstencil.width = boundaries.width * 0.8;\r\n\t\t\tstencil.height = stencil.width * ratio(coordinates);\r\n\t\t}\r\n\r\n\t\t// First of all try to resize visible area as much as possible:\r\n\t\tvisibleArea = applyScale(\r\n\t\t\tvisibleArea,\r\n\t\t\t(coordinates.width * boundaries.width) / (visibleArea.width * stencil.width),\r\n\t\t);\r\n\r\n\t\t// Check that visible area doesn't break the area restrictions:\r\n\t\tconst scale = adjustSize(visibleArea, getAreaRestrictions({ visibleArea, type: 'resize' }));\r\n\t\tvisibleArea = applyScale(visibleArea, scale);\r\n\r\n\t\tif (scale !== 1) {\r\n\t\t\tstencil.height /= scale;\r\n\t\t\tstencil.width /= scale;\r\n\t\t}\r\n\r\n\t\tvisibleArea = applyMove(visibleArea, diff(getCenter(coordinates), getCenter(visibleArea)));\r\n\r\n\t\t// Center stencil in visible area:\r\n\t\tvisibleArea = fitToLimits(visibleArea, getAreaRestrictions({ visibleArea, type: 'move' }));\r\n\t\tcoordinates = fitToLimits(coordinates, intersectionLimits(toLimits(visibleArea), positionRestrictions));\r\n\t}\r\n\r\n\treturn {\r\n\t\tcoordinates,\r\n\t\tvisibleArea,\r\n\t};\r\n}\r\n\r\n// The main point of this feature is calculating the needed position of stencil and parameters of world transforms\r\n// Real coordinates don't changes here\r\ninterface SimplestAutoZoomParams {\r\n\tevent: CropperEvent;\r\n\tcoordinates: Coordinates;\r\n\tvisibleArea: VisibleArea;\r\n\tgetAreaRestrictions: GetAreaRestrictions;\r\n}\r\nexport function simplestAutoZoom(params: SimplestAutoZoomParams): AutoZoomResult {\r\n\tconst { event, coordinates: originalCoordinates, visibleArea: originalVisibleArea, getAreaRestrictions } = params;\r\n\r\n\tlet visibleArea = { ...originalVisibleArea };\r\n\tconst coordinates = { ...originalCoordinates };\r\n\r\n\tif (event.type === 'setCoordinates') {\r\n\t\tconst widthIntersections = Math.max(0, coordinates.width - visibleArea.width);\r\n\t\tconst heightIntersections = Math.max(0, coordinates.height - visibleArea.height);\r\n\r\n\t\tif (widthIntersections > heightIntersections) {\r\n\t\t\tvisibleArea = applyScale(\r\n\t\t\t\tvisibleArea,\r\n\t\t\t\tMath.min(\r\n\t\t\t\t\tcoordinates.width / visibleArea.width,\r\n\t\t\t\t\tmaxScale(visibleArea, getAreaRestrictions({ visibleArea, type: 'resize' })),\r\n\t\t\t\t),\r\n\t\t\t);\r\n\t\t} else if (heightIntersections > widthIntersections) {\r\n\t\t\tvisibleArea = applyScale(\r\n\t\t\t\tvisibleArea,\r\n\t\t\t\tMath.min(\r\n\t\t\t\t\tcoordinates.height / visibleArea.height,\r\n\t\t\t\t\tmaxScale(visibleArea, getAreaRestrictions({ visibleArea, type: 'resize' })),\r\n\t\t\t\t),\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tvisibleArea = applyMove(visibleArea, inverseMove(fit(coordinates, toLimits(visibleArea))));\r\n\r\n\t\tvisibleArea = fitToLimits(visibleArea, getAreaRestrictions({ visibleArea, type: 'move' }));\r\n\t}\r\n\treturn {\r\n\t\tvisibleArea,\r\n\t\tcoordinates,\r\n\t};\r\n}\r\n","import { Boundaries, Size } from '../typings';\r\n\r\nexport interface DefaultBoundariesParams {\r\n\tcropper: HTMLElement;\r\n\timageSize: Size;\r\n}\r\nexport function fitBoundaries({ cropper, imageSize }: DefaultBoundariesParams): Boundaries {\r\n\tconst areaHeight = cropper.clientHeight;\r\n\tconst areaWidth = cropper.clientWidth;\r\n\r\n\tlet currentHeight = areaHeight;\r\n\tlet currentWidth = (imageSize.width * areaHeight) / imageSize.height;\r\n\r\n\tif (currentWidth > areaWidth) {\r\n\t\tcurrentWidth = areaWidth;\r\n\t\tcurrentHeight = (imageSize.height * areaWidth) / imageSize.width;\r\n\t}\r\n\r\n\treturn {\r\n\t\twidth: currentWidth,\r\n\t\theight: currentHeight,\r\n\t};\r\n}\r\nexport function fillBoundaries({ cropper }: DefaultBoundariesParams): Boundaries {\r\n\treturn {\r\n\t\twidth: cropper.clientWidth,\r\n\t\theight: cropper.clientHeight,\r\n\t};\r\n}\r\n","import { ImageSize, Point, Size, VisibleArea } from '../typings';\r\n\r\nexport interface DefaultPositionParams {\r\n\tcoordinates: Size;\r\n\timageSize?: ImageSize;\r\n\tvisibleArea?: VisibleArea;\r\n}\r\nexport function defaultPosition({ imageSize, visibleArea, coordinates }: DefaultPositionParams): Point {\r\n\tconst area = visibleArea || imageSize;\r\n\r\n\treturn {\r\n\t\tleft: (visibleArea ? visibleArea.left : 0) + area.width / 2 - coordinates.width / 2,\r\n\t\ttop: (visibleArea ? visibleArea.top : 0) + area.height / 2 - coordinates.height / 2,\r\n\t};\r\n}\r\n","import {\r\n\tAspectRatio,\r\n\tBoundaries,\r\n\tFalsy,\r\n\tImageSize,\r\n\tSize,\r\n\tSizeRestrictions,\r\n\tStencilSize,\r\n\tVisibleArea,\r\n} from '../typings';\r\nimport { approximatedSize } from './approximatedSize';\r\nimport { ratio } from '../service';\r\nimport { isNumber } from '../utils';\r\n\r\ninterface DefaultSizeBasicParams {\r\n\taspectRatio: AspectRatio;\r\n\tboundaries: Boundaries;\r\n\tsizeRestrictions: SizeRestrictions;\r\n}\r\n\r\ninterface ImageDefaultSizeParams extends DefaultSizeBasicParams {\r\n\timageSize: ImageSize;\r\n\tvisibleArea?: VisibleArea | Falsy;\r\n}\r\n\r\ninterface VisibleAreaDefaultSizeParams extends DefaultSizeBasicParams {\r\n\timageSize?: ImageSize | Falsy;\r\n\tvisibleArea: VisibleArea;\r\n}\r\n\r\nexport type DefaultSizeParams = VisibleAreaDefaultSizeParams | ImageDefaultSizeParams;\r\n\r\nexport function defaultSize(params: DefaultSizeParams): Size {\r\n\tconst { imageSize, visibleArea, aspectRatio, sizeRestrictions } = params;\r\n\r\n\tconst area = (visibleArea || imageSize) as Size;\r\n\r\n\tconst optimalRatio = Math.min(aspectRatio.maximum || Infinity, Math.max(aspectRatio.minimum || 0, ratio(area)));\r\n\r\n\tconst size =\r\n\t\tarea.width < area.height\r\n\t\t\t? {\r\n\t\t\t\t\twidth: area.width * 0.8,\r\n\t\t\t\t\theight: (area.width * 0.8) / optimalRatio,\r\n\t\t\t  }\r\n\t\t\t: {\r\n\t\t\t\t\theight: area.height * 0.8,\r\n\t\t\t\t\twidth: area.height * 0.8 * optimalRatio,\r\n\t\t\t  };\r\n\r\n\treturn approximatedSize({\r\n\t\t...size,\r\n\t\taspectRatio,\r\n\t\tsizeRestrictions: sizeRestrictions,\r\n\t});\r\n}\r\n\r\nexport type FixedDefaultSizeParams = DefaultSizeParams & { stencilSize: Size };\r\n\r\nexport function fixedDefaultSize(params: FixedDefaultSizeParams): Size {\r\n\tconst { imageSize, visibleArea, boundaries, aspectRatio, sizeRestrictions, stencilSize } = params;\r\n\r\n\tconst area = (visibleArea || imageSize) as Size;\r\n\r\n\tlet height, width;\r\n\tif (ratio(area) > ratio(boundaries)) {\r\n\t\theight = (stencilSize.height * area.height) / boundaries.height;\r\n\t\twidth = height * ratio(stencilSize);\r\n\t} else {\r\n\t\twidth = (stencilSize.width * area.width) / boundaries.width;\r\n\t\theight = width / ratio(stencilSize);\r\n\t}\r\n\r\n\treturn approximatedSize({\r\n\t\twidth,\r\n\t\theight,\r\n\t\taspectRatio,\r\n\t\tsizeRestrictions: sizeRestrictions,\r\n\t});\r\n}\r\n","import { Size, VisibleArea, Coordinates, GetAreaRestrictions, Limits, Falsy } from '../typings';\r\nimport { ratio, toLimits, intersectionLimits, fitToLimits, getIntersections, fitSize, limitsToSize } from '../service';\r\n\r\nexport interface DefaultVisibleAreaParams {\r\n\timageSize: Size;\r\n\tboundaries: Size;\r\n\tcoordinates?: Coordinates | Falsy;\r\n\tgetAreaRestrictions: GetAreaRestrictions;\r\n}\r\nexport function defaultVisibleArea(params: DefaultVisibleAreaParams): VisibleArea {\r\n\tconst { getAreaRestrictions, coordinates, imageSize, boundaries } = params;\r\n\r\n\tconst boundaryRatio = ratio(boundaries);\r\n\r\n\tif (coordinates) {\r\n\t\t// Visible area will try to fit reference:\r\n\t\tconst reference = {\r\n\t\t\theight: Math.max(coordinates.height, imageSize.height),\r\n\t\t\twidth: Math.max(coordinates.width, imageSize.width),\r\n\t\t};\r\n\r\n\t\tconst areaProperties = fitSize(\r\n\t\t\t{\r\n\t\t\t\twidth: ratio(reference) > boundaryRatio ? reference.width : reference.height * boundaryRatio,\r\n\t\t\t\theight: ratio(reference) > boundaryRatio ? reference.width / boundaryRatio : reference.height,\r\n\t\t\t},\r\n\t\t\tlimitsToSize(getAreaRestrictions()),\r\n\t\t);\r\n\r\n\t\t// Visible area will try to center stencil:\r\n\t\tconst visibleArea = {\r\n\t\t\tleft: coordinates.left + coordinates.width / 2 - areaProperties.width / 2,\r\n\t\t\ttop: coordinates.top + coordinates.height / 2 - areaProperties.height / 2,\r\n\t\t\twidth: areaProperties.width,\r\n\t\t\theight: areaProperties.height,\r\n\t\t};\r\n\r\n\t\t// TODO: Controversial behavior:\r\n\t\t// If the coordinates are beyond image visible area will be allowed to be beyond image alike:\r\n\t\tconst coordinatesIntersection = getIntersections(\r\n\t\t\tcoordinates,\r\n\t\t\ttoLimits({\r\n\t\t\t\tleft: 0,\r\n\t\t\t\ttop: 0,\r\n\t\t\t\t...imageSize,\r\n\t\t\t}),\r\n\t\t);\r\n\r\n\t\tconst limits: Limits = {};\r\n\r\n\t\tif (!coordinatesIntersection.left && !coordinatesIntersection.right && visibleArea.width <= imageSize.width) {\r\n\t\t\tlimits.left = 0;\r\n\t\t\tlimits.right = imageSize.width;\r\n\t\t}\r\n\r\n\t\tif (!coordinatesIntersection.top && !coordinatesIntersection.bottom && visibleArea.height <= imageSize.height) {\r\n\t\t\tlimits.top = 0;\r\n\t\t\tlimits.bottom = imageSize.height;\r\n\t\t}\r\n\r\n\t\treturn fitToLimits(visibleArea, limits);\r\n\t} else {\r\n\t\tconst imageRatio = ratio(imageSize);\r\n\r\n\t\tconst areaProperties = {\r\n\t\t\theight: imageRatio > boundaryRatio ? imageSize.height : imageSize.width / boundaryRatio,\r\n\t\t\twidth: imageRatio > boundaryRatio ? imageSize.height * boundaryRatio : imageSize.width,\r\n\t\t};\r\n\r\n\t\treturn {\r\n\t\t\tleft: imageSize.width / 2 - areaProperties.width / 2,\r\n\t\t\ttop: imageSize.height / 2 - areaProperties.height / 2,\r\n\t\t\twidth: areaProperties.width,\r\n\t\t\theight: areaProperties.height,\r\n\t\t};\r\n\t}\r\n}\r\n","import { AspectRatio, Coordinates, PositionRestrictions, SizeRestrictions, VisibleArea } from '../typings';\r\nimport { approximatedSize } from './approximatedSize';\r\nimport { applyMove, diff, fit, fitToLimits, getCenter, intersectionLimits, toLimits } from '../service';\r\n\r\nexport interface FitCoordinatesParams {\r\n\tvisibleArea: VisibleArea;\r\n\tcoordinates: Coordinates;\r\n\taspectRatio: AspectRatio;\r\n\tsizeRestrictions: SizeRestrictions;\r\n\tpositionRestrictions: PositionRestrictions;\r\n}\r\n\r\nexport function fitCoordinates(params: FitCoordinatesParams): Coordinates {\r\n\tconst {\r\n\t\tvisibleArea,\r\n\t\tcoordinates: previousCoordinates,\r\n\t\taspectRatio,\r\n\t\tsizeRestrictions,\r\n\t\tpositionRestrictions,\r\n\t} = params;\r\n\r\n\tlet coordinates = {\r\n\t\t...previousCoordinates,\r\n\t\t...approximatedSize({\r\n\t\t\twidth: previousCoordinates.width,\r\n\t\t\theight: previousCoordinates.height,\r\n\t\t\taspectRatio,\r\n\t\t\tsizeRestrictions: {\r\n\t\t\t\tmaxWidth: visibleArea.width,\r\n\t\t\t\tmaxHeight: visibleArea.height,\r\n\t\t\t\tminHeight: Math.min(visibleArea.height, sizeRestrictions.minHeight),\r\n\t\t\t\tminWidth: Math.min(visibleArea.width, sizeRestrictions.minWidth),\r\n\t\t\t},\r\n\t\t}),\r\n\t};\r\n\r\n\tcoordinates = applyMove(coordinates, diff(getCenter(previousCoordinates), getCenter(coordinates)));\r\n\r\n\tcoordinates = fitToLimits(coordinates, intersectionLimits(toLimits(visibleArea), positionRestrictions));\r\n\r\n\treturn coordinates;\r\n}\r\n","import { Size } from '../typings';\nimport { ratio } from '../service';\n\nexport interface InitStretcherParams {\n\tstretcher: HTMLElement;\n\timageSize: Size;\n}\nexport function initStretcher({ stretcher, imageSize }: InitStretcherParams): void {\n\tconst aspectRatio = ratio(imageSize);\n\tstretcher.style.width = `${imageSize.width}px`;\n\tstretcher.style.height = `${stretcher.clientWidth / aspectRatio}px`;\n\t// Prevent stretching in future until stretcher will be reinitialized\n\tstretcher.style.width = `${stretcher.clientWidth}px`;\n}\n","import { Coordinates, Limits } from '../typings';\r\nimport { joinLimits } from '../service';\r\nimport { toLimits } from '../service';\r\n\r\nexport function limitBy(limits: Limits, object: Coordinates): Limits {\r\n\treturn joinLimits(limits, toLimits(object));\r\n}\r\n","import { ManipulateImageEvent } from '../events';\r\nimport { GetAreaRestrictions, Coordinates, PositionRestrictions, SizeRestrictions, VisibleArea } from '../typings';\r\nimport {\r\n\tapplyMove,\r\n\tapplyScale,\r\n\tfit,\r\n\tfitToLimits,\r\n\tgetCenter,\r\n\tintersectionLimits,\r\n\tinverseMove,\r\n\tmaxScale,\r\n\ttoLimits,\r\n} from '../service';\r\n\r\ninterface ManipulateImageParams {\r\n\tevent: ManipulateImageEvent;\r\n\tcoordinates: Coordinates;\r\n\tvisibleArea: VisibleArea;\r\n\tsizeRestrictions: SizeRestrictions;\r\n\tpositionRestrictions: PositionRestrictions;\r\n\tgetAreaRestrictions: GetAreaRestrictions;\r\n\tadjustStencil: boolean;\r\n}\r\ninterface ManipulateImageResult {\r\n\tvisibleArea: VisibleArea;\r\n\tcoordinates: Coordinates;\r\n}\r\nexport function manipulateImage(params: ManipulateImageParams): ManipulateImageResult {\r\n\tconst {\r\n\t\tevent,\r\n\t\tcoordinates: originalCoordinates,\r\n\t\tvisibleArea: originalVisibleArea,\r\n\t\tsizeRestrictions,\r\n\t\tgetAreaRestrictions,\r\n\t\tpositionRestrictions,\r\n\t\tadjustStencil,\r\n\t} = params;\r\n\r\n\tconst { scale, move } = event;\r\n\r\n\tlet visibleArea = { ...originalVisibleArea };\r\n\tlet coordinates = { ...originalCoordinates };\r\n\r\n\tlet areaScale = 1;\r\n\tlet stencilScale = 1;\r\n\tconst allowedScale = scale.factor && Math.abs(scale.factor - 1) > 1e-3;\r\n\r\n\tvisibleArea = applyMove(visibleArea, {\r\n\t\tleft: move.left || 0,\r\n\t\ttop: move.top || 0,\r\n\t});\r\n\r\n\tconst scaleRestrictions = {\r\n\t\tstencil: {\r\n\t\t\tminimum: Math.max(\r\n\t\t\t\tsizeRestrictions.minWidth ? sizeRestrictions.minWidth / coordinates.width : 0,\r\n\t\t\t\tsizeRestrictions.minHeight ? sizeRestrictions.minHeight / coordinates.height : 0,\r\n\t\t\t),\r\n\t\t\tmaximum: Math.min(\r\n\t\t\t\tsizeRestrictions.maxWidth ? sizeRestrictions.maxWidth / coordinates.width : Infinity,\r\n\t\t\t\tsizeRestrictions.maxHeight ? sizeRestrictions.maxHeight / coordinates.height : Infinity,\r\n\t\t\t\tmaxScale(coordinates, positionRestrictions),\r\n\t\t\t),\r\n\t\t},\r\n\t\tarea: {\r\n\t\t\tmaximum: maxScale(visibleArea, getAreaRestrictions({ visibleArea, type: 'resize' })),\r\n\t\t},\r\n\t};\r\n\r\n\t// If there is scaling then begin scale\r\n\tif (scale.factor && allowedScale) {\r\n\t\t// Determine scale factor\r\n\t\tif (scale.factor < 1) {\r\n\t\t\tstencilScale = Math.max(scale.factor, scaleRestrictions.stencil.minimum);\r\n\t\t\tif (stencilScale > 1) {\r\n\t\t\t\tstencilScale = 1;\r\n\t\t\t}\r\n\t\t} else if (scale.factor > 1) {\r\n\t\t\tstencilScale = Math.min(\r\n\t\t\t\tscale.factor,\r\n\t\t\t\tMath.min(scaleRestrictions.area.maximum, scaleRestrictions.stencil.maximum),\r\n\t\t\t);\r\n\t\t\tif (stencilScale < 1) {\r\n\t\t\t\tstencilScale = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (stencilScale) {\r\n\t\t// Resize stencil with area as much is possible\r\n\t\tvisibleArea = applyScale(visibleArea, stencilScale, scale.center);\r\n\t}\r\n\r\n\tconst relativeCoordinates = {\r\n\t\tleft: originalCoordinates.left - originalVisibleArea.left,\r\n\t\tright:\r\n\t\t\toriginalVisibleArea.width +\r\n\t\t\toriginalVisibleArea.left -\r\n\t\t\t(originalCoordinates.width + originalCoordinates.left),\r\n\t\ttop: originalCoordinates.top - originalVisibleArea.top,\r\n\t\tbottom:\r\n\t\t\toriginalVisibleArea.height +\r\n\t\t\toriginalVisibleArea.top -\r\n\t\t\t(originalCoordinates.height + originalCoordinates.top),\r\n\t};\r\n\r\n\t// Move the area to fit to coordinates limits:\r\n\tvisibleArea = applyMove(\r\n\t\tvisibleArea,\r\n\t\tfit(visibleArea, {\r\n\t\t\tleft:\r\n\t\t\t\tpositionRestrictions.left !== undefined\r\n\t\t\t\t\t? positionRestrictions.left - relativeCoordinates.left * stencilScale\r\n\t\t\t\t\t: undefined,\r\n\t\t\ttop:\r\n\t\t\t\tpositionRestrictions.top !== undefined\r\n\t\t\t\t\t? positionRestrictions.top - relativeCoordinates.top * stencilScale\r\n\t\t\t\t\t: undefined,\r\n\t\t\tbottom:\r\n\t\t\t\tpositionRestrictions.bottom !== undefined\r\n\t\t\t\t\t? positionRestrictions.bottom + relativeCoordinates.bottom * stencilScale\r\n\t\t\t\t\t: undefined,\r\n\t\t\tright:\r\n\t\t\t\tpositionRestrictions.right !== undefined\r\n\t\t\t\t\t? positionRestrictions.right + relativeCoordinates.right * stencilScale\r\n\t\t\t\t\t: undefined,\r\n\t\t}),\r\n\t);\r\n\r\n\t// But the more important to fit are to the area restrictions, so we should fit it to that restrictions:\r\n\tvisibleArea = fitToLimits(visibleArea, getAreaRestrictions({ visibleArea, type: 'move' }));\r\n\r\n\t// Set the same coordinates of stencil inside visible area\r\n\tcoordinates.width = coordinates.width * stencilScale;\r\n\tcoordinates.height = coordinates.height * stencilScale;\r\n\tcoordinates.left = visibleArea.left + relativeCoordinates.left * stencilScale;\r\n\tcoordinates.top = visibleArea.top + relativeCoordinates.top * stencilScale;\r\n\r\n\t// Move the coordinates to prevent the intersection with visible area and position restrictions\r\n\tcoordinates = fitToLimits(coordinates, intersectionLimits(toLimits(visibleArea), positionRestrictions));\r\n\r\n\t// Resize only area if stencil can't be resized and stencil resize is disabled\r\n\tif (scale.factor && allowedScale && adjustStencil) {\r\n\t\tif (scale.factor > 1) {\r\n\t\t\tareaScale = Math.min(scaleRestrictions.area.maximum, scale.factor) / stencilScale;\r\n\t\t} else if (scale.factor < 1) {\r\n\t\t\tareaScale = Math.max(coordinates.height / visibleArea.height, scale.factor / stencilScale);\r\n\t\t}\r\n\t\tif (areaScale !== 1) {\r\n\t\t\tvisibleArea = applyScale(visibleArea, areaScale, scale.factor > 1 ? scale.center : getCenter(coordinates));\r\n\r\n\t\t\t// Move to prevent the breaking of the area restrictions:\r\n\t\t\tvisibleArea = fitToLimits(visibleArea, getAreaRestrictions({ visibleArea, type: 'move' }));\r\n\r\n\t\t\t// Move to prevent the intersection with coordinates:\r\n\t\t\tvisibleArea = applyMove(visibleArea, inverseMove(fit(coordinates, toLimits(visibleArea))));\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tcoordinates,\r\n\t\tvisibleArea,\r\n\t};\r\n}\r\n","import {\r\n\tAspectRatio,\r\n\tBoundaries,\r\n\tCoordinates,\r\n\tCropperEvent,\r\n\tGetAreaRestrictions,\r\n\tImageSize,\r\n\tPositionRestrictions,\r\n\tSize,\r\n\tSizeRestrictions,\r\n\tVisibleArea,\r\n} from '../typings';\r\nimport { isApproximatelyEqual, sign } from '../utils';\r\nimport {\r\n\tadjustSize,\r\n\tapplyMove,\r\n\tapplyScale,\r\n\tdiff,\r\n\tfitSize,\r\n\tfitToLimits,\r\n\tgetCenter,\r\n\tintersectionLimits,\r\n\tratio,\r\n\trotatePoint,\r\n\trotateSize,\r\n\ttoLimits,\r\n} from '../service';\r\nimport { approximatedSize } from './approximatedSize';\r\n\r\ninterface RotateImageParams {\r\n\taspectRatio: AspectRatio;\r\n\tcoordinates: Coordinates;\r\n\tvisibleArea: VisibleArea;\r\n\tsizeRestrictions: SizeRestrictions;\r\n\tpositionRestrictions: PositionRestrictions;\r\n\tgetAreaRestrictions: GetAreaRestrictions;\r\n\timageSize: ImageSize;\r\n\tpreviousImageSize: ImageSize;\r\n\tangle: number;\r\n}\r\n\r\ninterface RotateImageResult {\r\n\tvisibleArea: VisibleArea;\r\n\tcoordinates: Coordinates;\r\n}\r\n\r\nexport function rotateImage(params: RotateImageParams): RotateImageResult {\r\n\tconst {\r\n\t\taspectRatio,\r\n\t\tgetAreaRestrictions,\r\n\t\tcoordinates: originalCoordinates,\r\n\t\tvisibleArea: originalVisibleArea,\r\n\t\tsizeRestrictions,\r\n\t\tpositionRestrictions,\r\n\t\timageSize,\r\n\t\tpreviousImageSize,\r\n\t\tangle,\r\n\t} = params;\r\n\r\n\tlet coordinates = { ...originalCoordinates };\r\n\tlet visibleArea = { ...originalVisibleArea };\r\n\r\n\tconst imageCenter = rotatePoint(\r\n\t\tgetCenter({\r\n\t\t\tleft: 0,\r\n\t\t\ttop: 0,\r\n\t\t\t...previousImageSize,\r\n\t\t}),\r\n\t\tangle,\r\n\t);\r\n\r\n\tcoordinates = {\r\n\t\t...approximatedSize({\r\n\t\t\tsizeRestrictions,\r\n\t\t\taspectRatio,\r\n\t\t\twidth: coordinates.width,\r\n\t\t\theight: coordinates.height,\r\n\t\t}),\r\n\t\t...rotatePoint(getCenter(coordinates), angle),\r\n\t};\r\n\r\n\tcoordinates.left -= imageCenter.left - imageSize.width / 2 + coordinates.width / 2;\r\n\tcoordinates.top -= imageCenter.top - imageSize.height / 2 + coordinates.height / 2;\r\n\r\n\t// Check that visible area doesn't break the area restrictions:\r\n\tvisibleArea = applyScale(\r\n\t\tvisibleArea,\r\n\t\tadjustSize(visibleArea, getAreaRestrictions({ visibleArea, type: 'resize' })),\r\n\t);\r\n\r\n\tcoordinates = fitToLimits(coordinates, positionRestrictions);\r\n\r\n\tvisibleArea = applyMove(visibleArea, diff(getCenter(coordinates), getCenter(originalCoordinates)));\r\n\r\n\tvisibleArea = fitToLimits(visibleArea, getAreaRestrictions({ visibleArea, type: 'move' }));\r\n\r\n\treturn {\r\n\t\tcoordinates,\r\n\t\tvisibleArea,\r\n\t};\r\n}\r\n","import {\r\n\tAspectRatio,\r\n\tBoundaries,\r\n\tCoordinates,\r\n\tCropperEvent,\r\n\tGetAreaRestrictions,\r\n\tImageSize,\r\n\tPositionRestrictions,\r\n\tSize,\r\n\tSizeRestrictions,\r\n\tVisibleArea,\r\n} from '../typings';\r\nimport { isApproximatelyEqual, sign } from '../utils';\r\nimport {\r\n\tadjustSize,\r\n\tapplyMove,\r\n\tapplyScale,\r\n\tdiff,\r\n\tfitSize,\r\n\tfitToLimits,\r\n\tgetCenter,\r\n\tintersectionLimits,\r\n\tratio,\r\n\trotatePoint,\r\n\trotateSize,\r\n\ttoLimits,\r\n} from '../service';\r\nimport { approximatedSize } from './approximatedSize';\r\n\r\ninterface Reflect {\r\n\thorizontal: boolean;\r\n\tvertical: boolean;\r\n}\r\n\r\ninterface FlipImageParams {\r\n\taspectRatio: AspectRatio;\r\n\tcoordinates: Coordinates;\r\n\tvisibleArea: VisibleArea;\r\n\tgetAreaRestrictions: GetAreaRestrictions;\r\n\timageSize: ImageSize;\r\n\tpreviousFlip: Reflect;\r\n\tflip: Reflect;\r\n\trotate: number;\r\n}\r\n\r\ninterface FlipImageResult {\r\n\tvisibleArea: VisibleArea;\r\n\tcoordinates: Coordinates;\r\n}\r\n\r\nexport function flipImage(params: FlipImageParams): FlipImageResult {\r\n\tconst {\r\n\t\tflip,\r\n\t\tpreviousFlip,\r\n\t\trotate,\r\n\t\taspectRatio,\r\n\t\tgetAreaRestrictions,\r\n\t\tcoordinates: originalCoordinates,\r\n\t\tvisibleArea: originalVisibleArea,\r\n\t\timageSize,\r\n\t} = params;\r\n\r\n\tlet coordinates = { ...originalCoordinates };\r\n\tlet visibleArea = { ...originalVisibleArea };\r\n\r\n\tconst changed = {\r\n\t\thorizontal: previousFlip.horizontal !== flip.horizontal,\r\n\t\tvertical: previousFlip.vertical !== flip.vertical,\r\n\t};\r\n\r\n\tif (changed.horizontal || changed.vertical) {\r\n\t\tconst imageCenter = rotatePoint(\r\n\t\t\t{\r\n\t\t\t\tleft: imageSize.width / 2,\r\n\t\t\t\ttop: imageSize.height / 2,\r\n\t\t\t},\r\n\t\t\t-rotate,\r\n\t\t);\r\n\r\n\t\tlet oldCenter = rotatePoint(getCenter(coordinates), -rotate);\r\n\t\tlet newCenter = rotatePoint(\r\n\t\t\t{\r\n\t\t\t\tleft: changed.horizontal ? imageCenter.left - (oldCenter.left - imageCenter.left) : oldCenter.left,\r\n\t\t\t\ttop: changed.vertical ? imageCenter.top - (oldCenter.top - imageCenter.top) : oldCenter.top,\r\n\t\t\t},\r\n\t\t\trotate,\r\n\t\t);\r\n\t\tcoordinates = applyMove(coordinates, diff(newCenter, getCenter(coordinates)));\r\n\r\n\t\toldCenter = rotatePoint(getCenter(visibleArea), -rotate);\r\n\t\tnewCenter = rotatePoint(\r\n\t\t\t{\r\n\t\t\t\tleft: changed.horizontal ? imageCenter.left - (oldCenter.left - imageCenter.left) : oldCenter.left,\r\n\t\t\t\ttop: changed.vertical ? imageCenter.top - (oldCenter.top - imageCenter.top) : oldCenter.top,\r\n\t\t\t},\r\n\t\t\trotate,\r\n\t\t);\r\n\t\tvisibleArea = applyMove(visibleArea, diff(newCenter, getCenter(visibleArea)));\r\n\r\n\t\tvisibleArea = fitToLimits(visibleArea, getAreaRestrictions({ visibleArea, type: 'move' }));\r\n\t}\r\n\r\n\treturn {\r\n\t\tcoordinates,\r\n\t\tvisibleArea,\r\n\t};\r\n}\r\n","import { ManipulateImageEvent, MoveEvent, ResizeEvent } from '../events';\r\nimport { VisibleArea } from '../typings';\r\nimport { ALL_DIRECTIONS, MAIN_DIRECTIONS } from '../constants';\r\n\r\ninterface NormalizeEventParams {\r\n\tevent: ResizeEvent | MoveEvent | ManipulateImageEvent;\r\n\tvisibleArea: VisibleArea;\r\n\tcoefficient: number;\r\n}\r\nexport function normalizeEvent({ event, visibleArea, coefficient }: NormalizeEventParams) {\r\n\tif (event.type === 'manipulateImage') {\r\n\t\treturn {\r\n\t\t\t...event,\r\n\t\t\tmove: {\r\n\t\t\t\tleft: event.move && event.move.left ? coefficient * event.move.left : 0,\r\n\t\t\t\ttop: event.move && event.move.top ? coefficient * event.move.top : 0,\r\n\t\t\t},\r\n\t\t\tscale: {\r\n\t\t\t\tfactor: event.scale && event.scale.factor ? event.scale.factor : 1,\r\n\t\t\t\tcenter:\r\n\t\t\t\t\tevent.scale && event.scale.center\r\n\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\tleft: event.scale.center.left * coefficient + visibleArea.left,\r\n\t\t\t\t\t\t\t\ttop: event.scale.center.top * coefficient + visibleArea.top,\r\n\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t: null,\r\n\t\t\t},\r\n\t\t};\r\n\t} else if (event.type === 'resize') {\r\n\t\tconst normalizedEvent = { ...event, directions: { ...event.directions } };\r\n\t\tALL_DIRECTIONS.forEach((direction) => {\r\n\t\t\tnormalizedEvent.directions[direction] *= coefficient;\r\n\t\t});\r\n\t\treturn normalizedEvent;\r\n\t} else if (event.type === 'move') {\r\n\t\tconst normalizedEvent = { ...event, directions: { ...event.directions } };\r\n\t\tMAIN_DIRECTIONS.forEach((direction) => {\r\n\t\t\tnormalizedEvent.directions[direction] *= coefficient;\r\n\t\t});\r\n\t\treturn normalizedEvent;\r\n\t} else {\r\n\t\treturn event;\r\n\t}\r\n}\r\n","import { Size, SizeRestrictions } from '../typings';\r\n\r\nexport interface SizeRestrictionsParams {\r\n\timageSize: Size;\r\n\tminWidth: number;\r\n\tminHeight: number;\r\n\tmaxWidth: number;\r\n\tmaxHeight: number;\r\n}\r\nexport function percentRestrictions({\r\n\timageSize,\r\n\tminWidth,\r\n\tminHeight,\r\n\tmaxWidth,\r\n\tmaxHeight,\r\n}: SizeRestrictionsParams): SizeRestrictions {\r\n\treturn {\r\n\t\tminWidth: (minWidth / 100) * imageSize.width,\r\n\t\tminHeight: (minHeight / 100) * imageSize.height,\r\n\t\tmaxWidth: (maxWidth / 100) * imageSize.width,\r\n\t\tmaxHeight: (maxHeight / 100) * imageSize.height,\r\n\t};\r\n}\r\n\r\nexport function pixelsRestrictions({\r\n\tminWidth,\r\n\tminHeight,\r\n\tmaxWidth,\r\n\tmaxHeight,\r\n}: SizeRestrictionsParams): SizeRestrictions {\r\n\treturn {\r\n\t\tminWidth,\r\n\t\tminHeight,\r\n\t\tmaxWidth,\r\n\t\tmaxHeight,\r\n\t};\r\n}\r\n","import { ImageRestriction, Limits, Size } from '../typings';\r\n\r\nexport interface PositionRestrictionsParams {\r\n\timageRestriction: ImageRestriction;\r\n\timageSize: Size;\r\n}\r\nexport function positionRestrictions({ imageSize, imageRestriction }: PositionRestrictionsParams): Limits {\r\n\tlet limits = {};\r\n\r\n\tif (imageRestriction !== 'none') {\r\n\t\tlimits = {\r\n\t\t\tleft: 0,\r\n\t\t\ttop: 0,\r\n\t\t\tright: imageSize.width,\r\n\t\t\tbottom: imageSize.height,\r\n\t\t};\r\n\t}\r\n\r\n\treturn limits;\r\n}\r\n","import { Boundaries, ImageRestriction, PositionRestrictions, Size, SizeRestrictions, VisibleArea } from '../typings';\r\nimport { fitSize } from '../service';\r\n\r\ninterface RefineSizeRestrictionsParams {\r\n\tsizeRestrictions: Partial<SizeRestrictions>;\r\n\tpositionRestrictions: PositionRestrictions;\r\n\tboundaries: Boundaries;\r\n\timageSize: Size;\r\n\timageRestriction: ImageRestriction;\r\n}\r\nexport function refineSizeRestrictions({\r\n\tsizeRestrictions,\r\n\timageSize,\r\n\tboundaries,\r\n\tpositionRestrictions,\r\n\timageRestriction = 'none',\r\n}: RefineSizeRestrictionsParams) {\r\n\t// User can forget to set some of restrictions, so we should init them by default values\r\n\tconst restrictions = {\r\n\t\t...sizeRestrictions,\r\n\t\tminWidth: sizeRestrictions.minWidth !== undefined ? sizeRestrictions.minWidth : 0,\r\n\t\tminHeight: sizeRestrictions.minHeight !== undefined ? sizeRestrictions.minHeight : 0,\r\n\t\tmaxWidth: sizeRestrictions.maxWidth !== undefined ? sizeRestrictions.maxWidth : Infinity,\r\n\t\tmaxHeight: sizeRestrictions.maxHeight !== undefined ? sizeRestrictions.maxHeight : Infinity,\r\n\t};\r\n\r\n\t// The situation, when stencil can't be positioned in cropper due to positionRestrictions should be avoided\r\n\tif (positionRestrictions.left !== undefined && positionRestrictions.right !== undefined) {\r\n\t\trestrictions.maxWidth = Math.min(restrictions.maxWidth, positionRestrictions.right - positionRestrictions.left);\r\n\t}\r\n\tif (positionRestrictions.bottom !== undefined && positionRestrictions.top !== undefined) {\r\n\t\trestrictions.maxHeight = Math.min(\r\n\t\t\trestrictions.maxHeight,\r\n\t\t\tpositionRestrictions.bottom - positionRestrictions.top,\r\n\t\t);\r\n\t}\r\n\r\n\t// The situation when stencil larger than maximum visible area or image should be avoided if imageRestriction != 'none':\r\n\tif (imageRestriction !== 'none') {\r\n\t\tconst areaMaximum = fitSize(boundaries, imageSize);\r\n\t\tconst maxWidth = (imageRestriction === 'fill-area' || imageRestriction === 'area') ? areaMaximum.width : imageSize.width;\r\n\t\tconst maxHeight =( imageRestriction === 'fill-area' || imageRestriction === 'area') ? areaMaximum.height : imageSize.height;\r\n\r\n\t\tif (!restrictions.maxWidth || restrictions.maxWidth > maxWidth) {\r\n\t\t\trestrictions.maxWidth = Math.min(restrictions.maxWidth, maxWidth);\r\n\t\t}\r\n\t\tif (!restrictions.maxHeight || restrictions.maxHeight > maxHeight) {\r\n\t\t\trestrictions.maxHeight = Math.min(restrictions.maxHeight, maxHeight);\r\n\t\t}\r\n\t}\r\n\r\n\t// Process the border cases when minimum height / width larger than maximum height / width\r\n\tif (restrictions.minWidth > restrictions.maxWidth) {\r\n\t\tif (process.env.NODE_ENV !== 'production') {\r\n\t\t\tconsole.warn(\r\n\t\t\t\t`Warning: maximum width (${restrictions.maxWidth}px) fewer that the minimum width (${restrictions.minWidth}px). It is set equal to the minimum width and width resizing was blocked`,\r\n\t\t\t);\r\n\t\t}\r\n\t\trestrictions.minWidth = restrictions.maxWidth;\r\n\t\trestrictions.widthFrozen = true;\r\n\t}\r\n\r\n\tif (restrictions.minHeight > restrictions.maxHeight) {\r\n\t\tif (process.env.NODE_ENV !== 'production') {\r\n\t\t\tconsole.warn(\r\n\t\t\t\t`Warning: maximum height (${restrictions.maxHeight}px) fewer that the minimum height (${restrictions.minHeight}px). It is set equal to the minimum height and height resizing was blocked`,\r\n\t\t\t);\r\n\t\t}\r\n\t\trestrictions.minHeight = restrictions.maxHeight;\r\n\t\trestrictions.heightFrozen = true;\r\n\t}\r\n\r\n\treturn restrictions;\r\n}\r\n","import { GetAreaRestrictions, Boundaries, VisibleArea } from '../typings';\r\nimport { fitToLimits, ratio } from '../service';\r\n\r\ninterface RefineVisibleAreaParams {\r\n\tvisibleArea: VisibleArea;\r\n\tboundaries: Boundaries;\r\n\tgetAreaRestrictions: GetAreaRestrictions;\r\n}\r\nexport function refineVisibleArea(params: RefineVisibleAreaParams): VisibleArea {\r\n\tconst { visibleArea: previousVisibleArea, boundaries, getAreaRestrictions } = params;\r\n\r\n\tlet visibleArea = { ...previousVisibleArea };\r\n\r\n\tconst boundariesRatio = ratio(boundaries);\r\n\tif (visibleArea.width / visibleArea.height !== boundariesRatio) {\r\n\t\tvisibleArea.height = visibleArea.width / boundariesRatio;\r\n\t}\r\n\r\n\treturn fitToLimits(visibleArea, getAreaRestrictions({ visibleArea, type: 'move' }));\r\n}\r\n","import { MoveEvent, ResizeEvent } from '../events';\r\nimport { AspectRatio, Coordinates, Limits, PositionRestrictions, ResizeDirections, SizeRestrictions } from '../typings';\r\nimport { ALL_DIRECTIONS, HORIZONTAL_DIRECTIONS, VERTICAL_DIRECTIONS } from '../constants';\r\nimport { applyDirections, getBrokenRatio, getIntersections, ratio } from '../service';\r\nimport { move } from './move';\r\n\r\ninterface FitConditionsParams {\r\n\tdirections: ResizeDirections;\r\n\tcoordinates: Coordinates;\r\n\tpositionRestrictions: Limits;\r\n\tsizeRestrictions: SizeRestrictions;\r\n\tpreserveRatio?: boolean;\r\n\tcompensate?: boolean;\r\n}\r\n\r\nexport function fitConditions({\r\n\tdirections,\r\n\tcoordinates,\r\n\tpositionRestrictions = {},\r\n\tsizeRestrictions,\r\n\tpreserveRatio,\r\n\tcompensate,\r\n}: FitConditionsParams): ResizeDirections {\r\n\tconst fittedDirections = { ...directions };\r\n\r\n\tlet currentWidth = applyDirections(coordinates, fittedDirections).width;\r\n\tlet currentHeight = applyDirections(coordinates, fittedDirections).height;\r\n\r\n\t// Prevent strange resizes when the width or height of stencil becomes smaller than 0\r\n\tif (currentWidth < 0) {\r\n\t\tif (fittedDirections.left < 0 && fittedDirections.right < 0) {\r\n\t\t\tfittedDirections.left =\r\n\t\t\t\t-(coordinates.width - sizeRestrictions.minWidth) / (fittedDirections.left / fittedDirections.right);\r\n\t\t\tfittedDirections.right =\r\n\t\t\t\t-(coordinates.width - sizeRestrictions.minWidth) / (fittedDirections.right / fittedDirections.left);\r\n\t\t} else if (fittedDirections.left < 0) {\r\n\t\t\tfittedDirections.left = -(coordinates.width - sizeRestrictions.minWidth);\r\n\t\t} else if (fittedDirections.right < 0) {\r\n\t\t\tfittedDirections.right = -(coordinates.width - sizeRestrictions.minWidth);\r\n\t\t}\r\n\t}\r\n\tif (currentHeight < 0) {\r\n\t\tif (fittedDirections.top < 0 && fittedDirections.bottom < 0) {\r\n\t\t\tfittedDirections.top =\r\n\t\t\t\t-(coordinates.height - sizeRestrictions.minHeight) / (fittedDirections.top / fittedDirections.bottom);\r\n\t\t\tfittedDirections.bottom =\r\n\t\t\t\t-(coordinates.height - sizeRestrictions.minHeight) / (fittedDirections.bottom / fittedDirections.top);\r\n\t\t} else if (fittedDirections.top < 0) {\r\n\t\t\tfittedDirections.top = -(coordinates.height - sizeRestrictions.minHeight);\r\n\t\t} else if (fittedDirections.bottom < 0) {\r\n\t\t\tfittedDirections.bottom = -(coordinates.height - sizeRestrictions.minHeight);\r\n\t\t}\r\n\t}\r\n\r\n\t// Prevent breaking limits\r\n\tlet breaks = getIntersections(applyDirections(coordinates, fittedDirections), positionRestrictions);\r\n\r\n\tif (compensate) {\r\n\t\tif (breaks.left && breaks.left > 0 && breaks.right === 0) {\r\n\t\t\tfittedDirections.right += breaks.left;\r\n\t\t\tfittedDirections.left -= breaks.left;\r\n\t\t} else if (breaks.right && breaks.right > 0 && breaks.left === 0) {\r\n\t\t\tfittedDirections.left += breaks.right;\r\n\t\t\tfittedDirections.right -= breaks.right;\r\n\t\t}\r\n\r\n\t\tif (breaks.top && breaks.top > 0 && breaks.bottom === 0) {\r\n\t\t\tfittedDirections.bottom += breaks.top;\r\n\t\t\tfittedDirections.top -= breaks.top;\r\n\t\t} else if (breaks.bottom && breaks.bottom > 0 && breaks.top === 0) {\r\n\t\t\tfittedDirections.top += breaks.bottom;\r\n\t\t\tfittedDirections.bottom -= breaks.bottom;\r\n\t\t}\r\n\r\n\t\tbreaks = getIntersections(applyDirections(coordinates, fittedDirections), positionRestrictions);\r\n\t}\r\n\r\n\tconst maxResize = {\r\n\t\twidth: Infinity,\r\n\t\theight: Infinity,\r\n\t\tleft: Infinity,\r\n\t\tright: Infinity,\r\n\t\ttop: Infinity,\r\n\t\tbottom: Infinity,\r\n\t};\r\n\r\n\tALL_DIRECTIONS.forEach((direction) => {\r\n\t\tconst intersection = breaks[direction];\r\n\t\tif (intersection && fittedDirections[direction]) {\r\n\t\t\tmaxResize[direction] = Math.max(0, 1 - intersection / fittedDirections[direction]);\r\n\t\t}\r\n\t});\r\n\r\n\tif (preserveRatio) {\r\n\t\tconst multiplier = Math.min(...ALL_DIRECTIONS.map((direction) => maxResize[direction]));\r\n\t\tif (multiplier !== Infinity) {\r\n\t\t\tALL_DIRECTIONS.forEach((direction) => {\r\n\t\t\t\tfittedDirections[direction] *= multiplier;\r\n\t\t\t});\r\n\t\t}\r\n\t} else {\r\n\t\tALL_DIRECTIONS.forEach((direction) => {\r\n\t\t\tif (maxResize[direction] !== Infinity) {\r\n\t\t\t\tfittedDirections[direction] *= maxResize[direction];\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tcurrentWidth = applyDirections(coordinates, fittedDirections).width;\r\n\tcurrentHeight = applyDirections(coordinates, fittedDirections).height;\r\n\r\n\tif (fittedDirections.right + fittedDirections.left) {\r\n\t\tif (currentWidth > sizeRestrictions.maxWidth) {\r\n\t\t\tmaxResize.width =\r\n\t\t\t\t(sizeRestrictions.maxWidth - coordinates.width) / (fittedDirections.right + fittedDirections.left);\r\n\t\t} else if (currentWidth < sizeRestrictions.minWidth) {\r\n\t\t\tmaxResize.width =\r\n\t\t\t\t(sizeRestrictions.minWidth - coordinates.width) / (fittedDirections.right + fittedDirections.left);\r\n\t\t}\r\n\t}\r\n\r\n\tif (fittedDirections.bottom + fittedDirections.top) {\r\n\t\tif (currentHeight > sizeRestrictions.maxHeight) {\r\n\t\t\tmaxResize.height =\r\n\t\t\t\t(sizeRestrictions.maxHeight - coordinates.height) / (fittedDirections.bottom + fittedDirections.top);\r\n\t\t} else if (currentHeight < sizeRestrictions.minHeight) {\r\n\t\t\tmaxResize.height =\r\n\t\t\t\t(sizeRestrictions.minHeight - coordinates.height) / (fittedDirections.bottom + fittedDirections.top);\r\n\t\t}\r\n\t}\r\n\r\n\tif (preserveRatio) {\r\n\t\tconst multiplier = Math.min(maxResize.width, maxResize.height);\r\n\t\tif (multiplier !== Infinity) {\r\n\t\t\tALL_DIRECTIONS.forEach((direction) => {\r\n\t\t\t\tfittedDirections[direction] *= multiplier;\r\n\t\t\t});\r\n\t\t}\r\n\t} else {\r\n\t\tif (maxResize.width !== Infinity) {\r\n\t\t\tHORIZONTAL_DIRECTIONS.forEach((direction) => {\r\n\t\t\t\tfittedDirections[direction] *= maxResize.width;\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (maxResize.height !== Infinity) {\r\n\t\t\tVERTICAL_DIRECTIONS.forEach((direction) => {\r\n\t\t\t\tfittedDirections[direction] *= maxResize.height;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\treturn fittedDirections;\r\n}\r\n\r\nexport interface ResizeParams {\r\n\tevent: ResizeEvent;\r\n\tcoordinates: Coordinates;\r\n\taspectRatio: AspectRatio;\r\n\tsizeRestrictions: SizeRestrictions;\r\n\tpositionRestrictions: PositionRestrictions;\r\n}\r\n\r\nfunction distributeOverlap(overlap: number, first: number, second: number) {\r\n\tif (first == 0 && second == 0) {\r\n\t\treturn overlap / 2;\r\n\t} else if (first == 0) {\r\n\t\treturn 0;\r\n\t} else if (second == 0) {\r\n\t\treturn overlap;\r\n\t} else {\r\n\t\treturn overlap * Math.abs(first / (first + second));\r\n\t}\r\n}\r\n\r\nexport function resize(params: ResizeParams): Coordinates {\r\n\tconst { event, coordinates, aspectRatio, positionRestrictions, sizeRestrictions } = params;\r\n\tconst actualCoordinates = {\r\n\t\t...coordinates,\r\n\t\tright: coordinates.left + coordinates.width,\r\n\t\tbottom: coordinates.top + coordinates.height,\r\n\t};\r\n\r\n\tconst eventParams = event.params || {};\r\n\r\n\tlet directions = {\r\n\t\t...event.directions,\r\n\t};\r\n\r\n\tconst allowedDirections = eventParams.allowedDirections || {\r\n\t\tleft: true,\r\n\t\tright: true,\r\n\t\tbottom: true,\r\n\t\ttop: true,\r\n\t};\r\n\r\n\tif (sizeRestrictions.widthFrozen) {\r\n\t\tdirections.left = 0;\r\n\t\tdirections.right = 0;\r\n\t}\r\n\r\n\tif (sizeRestrictions.heightFrozen) {\r\n\t\tdirections.top = 0;\r\n\t\tdirections.bottom = 0;\r\n\t}\r\n\r\n\tALL_DIRECTIONS.forEach((direction) => {\r\n\t\tif (!allowedDirections[direction]) {\r\n\t\t\tdirections[direction] = 0;\r\n\t\t}\r\n\t});\r\n\r\n\t// 1. First step: determine the safe and desired area\r\n\tdirections = fitConditions({\r\n\t\tcoordinates: actualCoordinates,\r\n\t\tdirections,\r\n\t\tsizeRestrictions: sizeRestrictions,\r\n\t\tpositionRestrictions,\r\n\t});\r\n\r\n\t// 2. Second step: fix desired box to correspondent to aspect ratio\r\n\tlet currentWidth = applyDirections(actualCoordinates, directions).width;\r\n\tlet currentHeight = applyDirections(actualCoordinates, directions).height;\r\n\r\n\t// Checks ratio:\r\n\tlet ratioBroken = eventParams.preserveRatio\r\n\t\t? ratio(actualCoordinates)\r\n\t\t: getBrokenRatio(currentWidth / currentHeight, aspectRatio);\r\n\r\n\tif (ratioBroken) {\r\n\t\tlet { respectDirection } = eventParams;\r\n\t\tif (!respectDirection) {\r\n\t\t\tif (actualCoordinates.width >= actualCoordinates.height || ratioBroken === 1) {\r\n\t\t\t\trespectDirection = 'width';\r\n\t\t\t} else {\r\n\t\t\t\trespectDirection = 'height';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (respectDirection === 'width') {\r\n\t\t\tconst overlapHeight = currentWidth / ratioBroken - actualCoordinates.height;\r\n\t\t\tif (allowedDirections.top && allowedDirections.bottom) {\r\n\t\t\t\tconst { top, bottom } = directions;\r\n\t\t\t\tdirections.bottom = distributeOverlap(overlapHeight, bottom, top);\r\n\t\t\t\tdirections.top = distributeOverlap(overlapHeight, top, bottom);\r\n\t\t\t} else if (allowedDirections.bottom) {\r\n\t\t\t\tdirections.bottom = overlapHeight;\r\n\t\t\t} else if (allowedDirections.top) {\r\n\t\t\t\tdirections.top = overlapHeight;\r\n\t\t\t} else if (allowedDirections.right) {\r\n\t\t\t\tdirections.right = 0;\r\n\t\t\t} else if (allowedDirections.left) {\r\n\t\t\t\tdirections.left = 0;\r\n\t\t\t}\r\n\t\t} else if (respectDirection === 'height') {\r\n\t\t\tconst overlapWidth = actualCoordinates.width - currentHeight * ratioBroken;\r\n\t\t\tif (allowedDirections.left && allowedDirections.right) {\r\n\t\t\t\tconst { left, right } = directions;\r\n\t\t\t\tdirections.left = -distributeOverlap(overlapWidth, left, right);\r\n\t\t\t\tdirections.right = -distributeOverlap(overlapWidth, right, left);\r\n\t\t\t} else if (allowedDirections.left) {\r\n\t\t\t\tdirections.left = -overlapWidth;\r\n\t\t\t} else if (allowedDirections.right) {\r\n\t\t\t\tdirections.right = -overlapWidth;\r\n\t\t\t} else if (allowedDirections.top) {\r\n\t\t\t\tdirections.top = 0;\r\n\t\t\t} else if (allowedDirections.bottom) {\r\n\t\t\t\tdirections.bottom = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 3. Third step: check if desired box with correct aspect ratios break some limits and fit to this conditions\r\n\t\tdirections = fitConditions({\r\n\t\t\tdirections,\r\n\t\t\tcoordinates: actualCoordinates,\r\n\t\t\tsizeRestrictions: sizeRestrictions,\r\n\t\t\tpositionRestrictions,\r\n\t\t\tpreserveRatio: true,\r\n\t\t\tcompensate: eventParams.compensate,\r\n\t\t});\r\n\t}\r\n\r\n\t// 4. Check if ratio broken (temporary):\r\n\tcurrentWidth = applyDirections(actualCoordinates, directions).width;\r\n\tcurrentHeight = applyDirections(actualCoordinates, directions).height;\r\n\tratioBroken = eventParams.preserveRatio\r\n\t\t? ratio(actualCoordinates)\r\n\t\t: getBrokenRatio(currentWidth / currentHeight, aspectRatio);\r\n\tif (ratioBroken && Math.abs(ratioBroken - currentWidth / currentHeight) > 1e-3) {\r\n\t\tif (process.env.NODE_ENV !== 'production') {\r\n\t\t\tconsole.error(\r\n\t\t\t\t`Something went wrong and ratio was broken: ${currentWidth / currentHeight} instead of ${ratioBroken}`,\r\n\t\t\t);\r\n\t\t}\r\n\t\tALL_DIRECTIONS.forEach((direction) => {\r\n\t\t\tif (!allowedDirections[direction]) {\r\n\t\t\t\tdirections[direction] = 0;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\treturn move({\r\n\t\tevent: new MoveEvent({\r\n\t\t\tleft: -directions.left,\r\n\t\t\ttop: -directions.top,\r\n\t\t}),\r\n\t\tcoordinates: {\r\n\t\t\twidth: coordinates.width + directions.right + directions.left,\r\n\t\t\theight: coordinates.height + directions.top + directions.bottom,\r\n\t\t\tleft: coordinates.left,\r\n\t\t\ttop: coordinates.top,\r\n\t\t},\r\n\t\tpositionRestrictions,\r\n\t});\r\n}\r\n","import { Coordinates, PositionRestrictions, SizeRestrictions } from '../typings';\r\n\r\nexport interface RoundCoordinatesParams {\r\n\tcoordinates: Coordinates;\r\n\tsizeRestrictions: SizeRestrictions;\r\n\tpositionRestrictions: PositionRestrictions;\r\n}\r\nexport function roundCoordinates({\r\n\tcoordinates,\r\n\tsizeRestrictions,\r\n\tpositionRestrictions,\r\n}: RoundCoordinatesParams): Coordinates {\r\n\tconst roundedCoordinates = {\r\n\t\twidth: Math.round(coordinates.width),\r\n\t\theight: Math.round(coordinates.height),\r\n\t\tleft: Math.round(coordinates.left),\r\n\t\ttop: Math.round(coordinates.top),\r\n\t};\r\n\r\n\tif (roundedCoordinates.width > sizeRestrictions.maxWidth) {\r\n\t\troundedCoordinates.width = Math.floor(coordinates.width);\r\n\t} else if (roundedCoordinates.width < sizeRestrictions.minWidth) {\r\n\t\troundedCoordinates.width = Math.ceil(coordinates.width);\r\n\t}\r\n\tif (roundedCoordinates.height > sizeRestrictions.maxHeight) {\r\n\t\troundedCoordinates.height = Math.floor(coordinates.height);\r\n\t} else if (roundedCoordinates.height < sizeRestrictions.minHeight) {\r\n\t\troundedCoordinates.height = Math.ceil(coordinates.height);\r\n\t}\r\n\tif (\r\n\t\tpositionRestrictions.left !== undefined &&\r\n\t\t(roundedCoordinates.left < positionRestrictions.left ||\r\n\t\t\t(positionRestrictions.right !== undefined &&\r\n\t\t\t\troundedCoordinates.left + roundedCoordinates.width > positionRestrictions.right))\r\n\t) {\r\n\t\troundedCoordinates.left = Math.floor(positionRestrictions.left);\r\n\t}\r\n\tif (\r\n\t\tpositionRestrictions.top !== undefined &&\r\n\t\t(roundedCoordinates.top < positionRestrictions.top ||\r\n\t\t\t(positionRestrictions.bottom !== undefined &&\r\n\t\t\t\troundedCoordinates.top + roundedCoordinates.height > positionRestrictions.bottom))\r\n\t) {\r\n\t\troundedCoordinates.top = Math.floor(positionRestrictions.top);\r\n\t}\r\n\r\n\treturn roundedCoordinates;\r\n}\r\n","import {\r\n\tadjustSize,\r\n\tapplyMove,\r\n\tapplyScale,\r\n\tfit,\r\n\tfitToLimits,\r\n\tgetIntersections,\r\n\tinverseMove,\r\n\tmaxScale,\r\n\tratio,\r\n\ttoLimits,\r\n} from '../service';\r\nimport { Coordinates, AreaRestrictions, VisibleArea, Boundaries, GetAreaRestrictions } from '../typings';\r\n\r\n// This function updates visible area with respect to current transformations and fits\r\n// coordinates to the new visible area\r\nexport interface FitVisibleAreaParams {\r\n\tgetAreaRestrictions: GetAreaRestrictions;\r\n\tcoordinates: Coordinates;\r\n\tvisibleArea: VisibleArea;\r\n\tboundaries: Boundaries;\r\n}\r\nexport function fitVisibleArea(params: FitVisibleAreaParams): VisibleArea {\r\n\tconst { visibleArea: previousVisibleArea, boundaries, getAreaRestrictions, coordinates } = params;\r\n\r\n\tlet visibleArea = { ...previousVisibleArea };\r\n\r\n\t// Scale visible area size to fit new boundaries:\r\n\tvisibleArea.height = visibleArea.width / ratio(boundaries);\r\n\tvisibleArea.top += (previousVisibleArea.height - visibleArea.height) / 2;\r\n\r\n\t// Scale visible area to prevent overlap coordinates\r\n\tif (coordinates.height - visibleArea.height > 0 || coordinates.width - visibleArea.width > 0) {\r\n\t\tvisibleArea = applyScale(\r\n\t\t\tvisibleArea,\r\n\t\t\tMath.max(coordinates.height / visibleArea.height, coordinates.width / visibleArea.width),\r\n\t\t);\r\n\t}\r\n\r\n\t// Scale visible area to prevent overlap area restrictions\r\n\tvisibleArea = applyScale(\r\n\t\tvisibleArea,\r\n\t\tadjustSize(visibleArea, getAreaRestrictions({ visibleArea, type: 'resize' })),\r\n\t);\r\n\r\n\t// Move visible are to prevent moving of the coordinates:\r\n\tconst move = inverseMove(fit(coordinates, toLimits(visibleArea)));\r\n\tif (visibleArea.width < coordinates.width) {\r\n\t\tmove.left = 0;\r\n\t}\r\n\tif (visibleArea.height < coordinates.height) {\r\n\t\tmove.top = 0;\r\n\t}\r\n\tvisibleArea = applyMove(visibleArea, move);\r\n\r\n\t// Move visible area to prevent overlap the area restrictions\r\n\tvisibleArea = fitToLimits(visibleArea, getAreaRestrictions({ visibleArea, type: 'move' }));\r\n\r\n\treturn visibleArea;\r\n}\r\n","import {\r\n\tAspectRatio,\r\n\tBoundaries,\r\n\tCoordinates,\r\n\tGetAreaRestrictions,\r\n\tPositionRestrictions,\r\n\tSize,\r\n\tSizeRestrictions,\r\n\tStencilSize,\r\n\tPosition,\r\n\tVisibleArea,\r\n\tStencilCalculationParams,\r\n} from '../typings';\r\nimport { isFunction, isUndefined } from '../utils';\r\nimport { adjustSize, applyScale, fitToLimits, getBrokenRatio, intersectionLimits, ratio, toLimits } from '../service';\r\nimport { approximatedSize } from './approximatedSize';\r\n\r\nexport interface CalculateStencilSizeParams {\r\n\taspectRatio: AspectRatio;\r\n\tstencilSize: StencilSize;\r\n\tboundaries: Boundaries;\r\n}\r\nexport function calculateStencilSize(params: CalculateStencilSizeParams): Size {\r\n\tconst { boundaries, stencilSize, aspectRatio } = params;\r\n\r\n\t// Checks that coordinates has the same ratio that coordinates:\r\n\tlet stencil = isFunction(stencilSize)\r\n\t\t? (stencilSize as Function)({ boundaries, aspectRatio })\r\n\t\t: stencilSize;\r\n\r\n\tif (getBrokenRatio(ratio(stencil), aspectRatio)) {\r\n\t\tif (process.env.NODE_ENV !== 'production') {\r\n\t\t\tconsole.error(\r\n\t\t\t\t`[Adjusting stencil] The aspect ratio of stencil doesn't correspondent to aspect ratio limitations`,\r\n\t\t\t);\r\n\t\t}\r\n\t\tstencil = approximatedSize({\r\n\t\t\tsizeRestrictions: {\r\n\t\t\t\tmaxWidth: boundaries.width,\r\n\t\t\t\tmaxHeight: boundaries.height,\r\n\t\t\t\tminWidth: 0,\r\n\t\t\t\tminHeight: 0,\r\n\t\t\t},\r\n\t\t\twidth: stencil.width,\r\n\t\t\theight: stencil.height,\r\n\t\t\taspectRatio: {\r\n\t\t\t\tminimum: aspectRatio.minimum,\r\n\t\t\t\tmaximum: aspectRatio.maximum,\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\tif (stencil.width > boundaries.width || stencil.height > boundaries.height) {\r\n\t\tif (process.env.NODE_ENV !== 'production') {\r\n\t\t\tconsole.error(\r\n\t\t\t\t`[Adjusting stencil] The width and height of stencil (${stencil.width}, ${stencil.height}) should be fewer or equal to the width and height of boundaries (${boundaries.width},${boundaries.height}) respectively`,\r\n\t\t\t);\r\n\t\t}\r\n\t\tstencil = approximatedSize({\r\n\t\t\tsizeRestrictions: {\r\n\t\t\t\tmaxWidth: boundaries.width,\r\n\t\t\t\tmaxHeight: boundaries.height,\r\n\t\t\t\tminWidth: 0,\r\n\t\t\t\tminHeight: 0,\r\n\t\t\t},\r\n\t\t\twidth: stencil.width,\r\n\t\t\theight: stencil.height,\r\n\t\t\taspectRatio: {\r\n\t\t\t\tminimum: ratio(stencil),\r\n\t\t\t\tmaximum: ratio(stencil),\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\treturn stencil;\r\n}\r\n","import { DragEvent } from '../core/events';\r\n\r\nexport default {\r\n\tbeforeMount() {\r\n\t\twindow.addEventListener('mouseup', this.onMouseUp, { passive: false });\r\n\t\twindow.addEventListener('mousemove', this.onMouseMove, { passive: false });\r\n\t\twindow.addEventListener('touchmove', this.onTouchMove, { passive: false });\r\n\t\twindow.addEventListener('touchend', this.onTouchEnd, { passive: false });\r\n\t},\r\n\tbeforeDestroy() {\r\n\t\twindow.removeEventListener('mouseup', this.onMouseUp);\r\n\t\twindow.removeEventListener('mousemove', this.onMouseMove);\r\n\t\twindow.removeEventListener('touchmove', this.onTouchMove);\r\n\t\twindow.removeEventListener('touchend', this.onTouchEnd);\r\n\t},\r\n\tmounted() {\r\n\t\tif (!this.$refs.draggable) {\r\n\t\t\tthrow new Error('You should add ref \"draggable\" to your root element to use draggable mixin');\r\n\t\t}\r\n\t\tthis.touches = [];\r\n\t\tthis.hovered = false;\r\n\t},\r\n\tmethods: {\r\n\t\tonMouseOver() {\r\n\t\t\tif (!this.hovered) {\r\n\t\t\t\tthis.hovered = true;\r\n\t\t\t\tthis.$emit('enter');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseLeave() {\r\n\t\t\tif (this.hovered && !this.touches.length) {\r\n\t\t\t\tthis.hovered = false;\r\n\t\t\t\tthis.$emit('leave');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTouchStart(e) {\r\n\t\t\tif (e.cancelable && !this.disabled && e.touches.length === 1) {\r\n\t\t\t\tthis.touches = [...e.touches];\r\n\r\n\t\t\t\tif (!this.hovered) {\r\n\t\t\t\t\tthis.$emit('enter');\r\n\t\t\t\t\tthis.hovered = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (e.touches.length) {\r\n\t\t\t\t\tthis.initAnchor(\r\n\t\t\t\t\t\tthis.touches.reduce(\r\n\t\t\t\t\t\t\t(mean, touch) => {\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\tclientX: mean.clientX + touch.clientX / e.touches.length,\r\n\t\t\t\t\t\t\t\t\tclientY: mean.clientY + touch.clientY / e.touches.length,\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{ clientX: 0, clientY: 0 },\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (e.preventDefault) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTouchEnd() {\r\n\t\t\tthis.processEnd();\r\n\t\t},\r\n\t\tonTouchMove(e) {\r\n\t\t\tif (this.touches.length) {\r\n\t\t\t\tthis.processMove(e, e.touches);\r\n\t\t\t\tif (e.preventDefault) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\tif (e.stopPropagation) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseDown(e) {\r\n\t\t\tif (!this.disabled) {\r\n\t\t\t\tconst touch = {\r\n\t\t\t\t\tfake: true,\r\n\t\t\t\t\tclientX: e.clientX,\r\n\t\t\t\t\tclientY: e.clientY,\r\n\t\t\t\t};\r\n\t\t\t\tthis.touches = [touch];\r\n\t\t\t\tthis.initAnchor(touch);\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseMove(e) {\r\n\t\t\tif (this.touches.length) {\r\n\t\t\t\tthis.processMove(e, [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfake: true,\r\n\t\t\t\t\t\tclientX: e.clientX,\r\n\t\t\t\t\t\tclientY: e.clientY,\r\n\t\t\t\t\t},\r\n\t\t\t\t]);\r\n\t\t\t\tif (e.preventDefault) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseUp() {\r\n\t\t\tthis.processEnd();\r\n\t\t},\r\n\t\tinitAnchor(touch) {\r\n\t\t\tconst draggable = this.$refs.draggable;\r\n\t\t\tconst { left, right, bottom, top } = draggable.getBoundingClientRect();\r\n\r\n\t\t\tthis.anchor = {\r\n\t\t\t\tleft: touch.clientX - left,\r\n\t\t\t\ttop: touch.clientY - top,\r\n\t\t\t\tbottom: bottom - touch.clientY,\r\n\t\t\t\tright: right - touch.clientX,\r\n\t\t\t};\r\n\t\t},\r\n\t\tprocessMove(event, touches) {\r\n\t\t\tconst newTouches = [...touches];\r\n\t\t\tif (this.touches.length) {\r\n\t\t\t\tif (this.touches.length === 1 && newTouches.length === 1) {\r\n\t\t\t\t\tconst element = this.$refs.draggable;\r\n\t\t\t\t\tthis.$emit(\r\n\t\t\t\t\t\t'drag',\r\n\t\t\t\t\t\tnew DragEvent(\r\n\t\t\t\t\t\t\tevent,\r\n\t\t\t\t\t\t\telement,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tleft: newTouches[0].clientX,\r\n\t\t\t\t\t\t\t\ttop: newTouches[0].clientY,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tleft: this.touches[0].clientX,\r\n\t\t\t\t\t\t\t\ttop: this.touches[0].clientY,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tthis.anchor,\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tthis.touches = newTouches;\r\n\t\t\t}\r\n\t\t},\r\n\t\tprocessEnd() {\r\n\t\t\tif (this.touches.length) {\r\n\t\t\t\tthis.$emit('drag-end');\r\n\t\t\t}\r\n\t\t\tif (this.hovered) {\r\n\t\t\t\tthis.$emit('leave');\r\n\t\t\t\tthis.hovered = false;\r\n\t\t\t}\r\n\t\t\tthis.touches = [];\r\n\t\t},\r\n\t},\r\n};\r\n","function normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier /* server only */, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\r\n    if (typeof shadowMode !== 'boolean') {\r\n        createInjectorSSR = createInjector;\r\n        createInjector = shadowMode;\r\n        shadowMode = false;\r\n    }\r\n    // Vue.extend constructor export interop.\r\n    const options = typeof script === 'function' ? script.options : script;\r\n    // render functions\r\n    if (template && template.render) {\r\n        options.render = template.render;\r\n        options.staticRenderFns = template.staticRenderFns;\r\n        options._compiled = true;\r\n        // functional template\r\n        if (isFunctionalTemplate) {\r\n            options.functional = true;\r\n        }\r\n    }\r\n    // scopedId\r\n    if (scopeId) {\r\n        options._scopeId = scopeId;\r\n    }\r\n    let hook;\r\n    if (moduleIdentifier) {\r\n        // server build\r\n        hook = function (context) {\r\n            // 2.3 injection\r\n            context =\r\n                context || // cached call\r\n                    (this.$vnode && this.$vnode.ssrContext) || // stateful\r\n                    (this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext); // functional\r\n            // 2.2 with runInNewContext: true\r\n            if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\r\n                context = __VUE_SSR_CONTEXT__;\r\n            }\r\n            // inject component styles\r\n            if (style) {\r\n                style.call(this, createInjectorSSR(context));\r\n            }\r\n            // register component module identifier for async chunk inference\r\n            if (context && context._registeredComponents) {\r\n                context._registeredComponents.add(moduleIdentifier);\r\n            }\r\n        };\r\n        // used by ssr in case component is cached and beforeCreate\r\n        // never gets called\r\n        options._ssrRegister = hook;\r\n    }\r\n    else if (style) {\r\n        hook = shadowMode\r\n            ? function (context) {\r\n                style.call(this, createInjectorShadow(context, this.$root.$options.shadowRoot));\r\n            }\r\n            : function (context) {\r\n                style.call(this, createInjector(context));\r\n            };\r\n    }\r\n    if (hook) {\r\n        if (options.functional) {\r\n            // register for functional component in vue file\r\n            const originalRender = options.render;\r\n            options.render = function renderWithStyleInjection(h, context) {\r\n                hook.call(context);\r\n                return originalRender(h, context);\r\n            };\r\n        }\r\n        else {\r\n            // inject component registration as beforeCreate hook\r\n            const existing = options.beforeCreate;\r\n            options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\r\n        }\r\n    }\r\n    return script;\r\n}\n\nexport default normalizeComponent;\n//# sourceMappingURL=normalize-component.mjs.map\n","import { Coordinates } from './typings';\r\n\r\nexport function updateCanvas(\r\n\tcanvas: HTMLCanvasElement,\r\n\tsource: HTMLCanvasElement | HTMLImageElement,\r\n\tcoordinates: Coordinates,\r\n\tresultCoordinates?: Coordinates,\r\n) {\r\n\tcanvas.width = resultCoordinates ? resultCoordinates.width : coordinates.width;\r\n\tcanvas.height = resultCoordinates ? resultCoordinates.height : coordinates.height;\r\n\r\n\tconst ctx = canvas.getContext('2d');\r\n\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\tctx.drawImage(\r\n\t\tsource,\r\n\t\tcoordinates.left,\r\n\t\tcoordinates.top,\r\n\t\tcoordinates.width,\r\n\t\tcoordinates.height,\r\n\t\t0,\r\n\t\t0,\r\n\t\tcanvas.width,\r\n\t\tcanvas.height,\r\n\t);\r\n}\r\n","import { ImageTransforms } from './typings';\nimport { getCenter, rotatePoint, rotateSize } from './service';\n\nexport const XHR_DONE = 4;\n\nexport function prepareSource(canvas, image, { rotate, flip }) {\n\tconst originalSize = {\n\t\twidth: image.naturalWidth,\n\t\theight: image.naturalHeight,\n\t};\n\n\tconst transformedSize = rotateSize(originalSize, rotate);\n\n\tconst ctx = canvas.getContext('2d');\n\tcanvas.height = transformedSize.height;\n\tcanvas.width = transformedSize.width;\n\n\tctx.save();\n\n\t// Rotation:\n\tconst originalCenter = {\n\t\tleft: originalSize.width / 2,\n\t\ttop: originalSize.height / 2,\n\t};\n\n\tlet canvasCenter = rotatePoint(\n\t\tgetCenter({\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\t...originalSize,\n\t\t}),\n\t\trotate,\n\t);\n\n\tctx.translate(-(canvasCenter.left - transformedSize.width / 2), -(canvasCenter.top - transformedSize.height / 2));\n\tctx.rotate((rotate * Math.PI) / 180);\n\n\t// Reflection;\n\tctx.translate(flip.horizontal ? originalSize.width : 0, flip.vertical ? originalSize.height : 0);\n\tctx.scale(flip.horizontal ? -1 : 1, flip.vertical ? -1 : 1);\n\n\tctx.drawImage(image, 0, 0, originalSize.width, originalSize.height);\n\tctx.restore();\n\n\treturn canvas;\n}\n\nfunction base64ToArrayBuffer(base64) {\n\tbase64 = base64.replace(/^data:([^;]+);base64,/gim, '');\n\tconst binary = atob(base64);\n\tconst len = binary.length;\n\tconst buffer = new ArrayBuffer(len);\n\tconst view = new Uint8Array(buffer);\n\tfor (let i = 0; i < len; i++) {\n\t\tview[i] = binary.charCodeAt(i);\n\t}\n\treturn buffer;\n}\n\nfunction objectURLToBlob(url, callback) {\n\tconst http = new XMLHttpRequest();\n\thttp.open('GET', url, true);\n\thttp.responseType = 'blob';\n\thttp.onload = function () {\n\t\tif (this.status == 200 || this.status === 0) {\n\t\t\tcallback(this.response);\n\t\t}\n\t};\n\thttp.send();\n}\n\nexport function getImageTransforms(orientation: number) {\n\tconst result: ImageTransforms = {\n\t\tflip: {\n\t\t\thorizontal: false,\n\t\t\tvertical: false,\n\t\t},\n\t\trotate: 0,\n\t};\n\tif (orientation) {\n\t\tswitch (orientation) {\n\t\t\tcase 2:\n\t\t\t\tresult.flip.horizontal = true;\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tresult.rotate = -180;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tresult.flip.vertical = true;\n\t\t\t\tbreak;\n\t\t\tcase 5:\n\t\t\t\tresult.rotate = 90;\n\t\t\t\tresult.flip.vertical = true;\n\t\t\t\tbreak;\n\t\t\tcase 6:\n\t\t\t\tresult.rotate = 90;\n\t\t\t\tbreak;\n\t\t\tcase 7:\n\t\t\t\tresult.rotate = 90;\n\t\t\t\tresult.flip.horizontal = true;\n\t\t\t\tbreak;\n\t\t\tcase 8:\n\t\t\t\tresult.rotate = -90;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn result;\n}\nfunction getImageData(img) {\n\treturn new Promise((resolve, reject) => {\n\t\ttry {\n\t\t\tif (img) {\n\t\t\t\tif (/^data:/i.test(img)) {\n\t\t\t\t\t// Data URL\n\t\t\t\t\tresolve(base64ToArrayBuffer(img));\n\t\t\t\t} else if (/^blob:/i.test(img)) {\n\t\t\t\t\t// Blob\n\t\t\t\t\tconst fileReader = new FileReader();\n\t\t\t\t\tfileReader.onload = function (e) {\n\t\t\t\t\t\tresolve(e.target.result);\n\t\t\t\t\t};\n\t\t\t\t\tobjectURLToBlob(img, function (blob) {\n\t\t\t\t\t\tfileReader.readAsArrayBuffer(blob);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// Simple URL\n\t\t\t\t\tlet http = new XMLHttpRequest();\n\t\t\t\t\thttp.onreadystatechange = function () {\n\t\t\t\t\t\tif (http.readyState !== XHR_DONE) return;\n\n\t\t\t\t\t\tif (http.status === 200 || http.status === 0) {\n\t\t\t\t\t\t\tresolve(http.response);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treject('Warning: could not load an image to parse its orientation');\n\t\t\t\t\t\t}\n\t\t\t\t\t\thttp = null;\n\t\t\t\t\t};\n\t\t\t\t\thttp.onprogress = function () {\n\t\t\t\t\t\t// Abort the request directly if it not a JPEG image for better performance\n\t\t\t\t\t\tif (http.getResponseHeader('content-type') !== 'image/jpeg') {\n\t\t\t\t\t\t\thttp.abort();\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\thttp.withCredentials = false;\n\t\t\t\t\thttp.open('GET', img, true);\n\t\t\t\t\thttp.responseType = 'arraybuffer';\n\t\t\t\t\thttp.send(null);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treject('Error: the image is empty');\n\t\t\t}\n\t\t} catch (e) {\n\t\t\treject(e);\n\t\t}\n\t});\n}\n\nexport function getStyleTransforms({ rotate, flip }) {\n\tlet transform = '';\n\tif (rotate) {\n\t\ttransform += ` rotate(${rotate}deg) `;\n\t}\n\ttransform += ` scaleX(${flip.horizontal ? -1 : 1}) `;\n\ttransform += ` scaleY(${flip.vertical ? -1 : 1}) `;\n\treturn transform;\n}\n\nfunction getStringFromCharCode(dataView, start, length) {\n\tlet str = '';\n\tlet i;\n\tfor (i = start, length += start; i < length; i++) {\n\t\tstr += String.fromCharCode(dataView.getUint8(i));\n\t}\n\treturn str;\n}\n\nfunction getOrientation(arrayBuffer) {\n\ttry {\n\t\tconst dataView = new DataView(arrayBuffer);\n\t\tlet orientation;\n\t\tlet exifIDCode;\n\t\tlet tiffOffset;\n\t\tlet littleEndian;\n\t\tlet app1Start;\n\t\tlet ifdStart;\n\t\t// Only handle JPEG image (start by 0xFFD8)\n\t\tif (dataView.getUint8(0) === 0xff && dataView.getUint8(1) === 0xd8) {\n\t\t\tconst length = dataView.byteLength;\n\t\t\tlet offset = 2;\n\t\t\twhile (offset + 1 < length) {\n\t\t\t\tif (dataView.getUint8(offset) === 0xff && dataView.getUint8(offset + 1) === 0xe1) {\n\t\t\t\t\tapp1Start = offset;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\toffset++;\n\t\t\t}\n\t\t}\n\t\tif (app1Start) {\n\t\t\texifIDCode = app1Start + 4;\n\t\t\ttiffOffset = app1Start + 10;\n\t\t\tif (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\n\t\t\t\tconst endianness = dataView.getUint16(tiffOffset);\n\n\t\t\t\tlittleEndian = endianness === 0x4949;\n\n\t\t\t\tif (littleEndian || endianness === 0x4d4d /* bigEndian */) {\n\t\t\t\t\tif (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002a) {\n\t\t\t\t\t\tconst firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\n\t\t\t\t\t\tif (firstIFDOffset >= 0x00000008) {\n\t\t\t\t\t\t\tifdStart = tiffOffset + firstIFDOffset;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (ifdStart) {\n\t\t\tconst length = dataView.getUint16(ifdStart, littleEndian);\n\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tlet offset = ifdStart + i * 12 + 2;\n\t\t\t\tif (dataView.getUint16(offset, littleEndian) === 0x0112 /* Orientation */) {\n\t\t\t\t\t// 8 is the offset of the current tag's value\n\t\t\t\t\toffset += 8;\n\t\t\t\t\t// Get the original orientation value\n\t\t\t\t\torientation = dataView.getUint16(offset, littleEndian);\n\t\t\t\t\t// Override the orientation with its default value\n\t\t\t\t\tdataView.setUint16(offset, 1, littleEndian);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn orientation;\n\t} catch (error) {\n\t\treturn null;\n\t}\n}\n\nexport function parseImage(src: string) {\n\treturn new Promise((resolve) => {\n\t\tgetImageData(src)\n\t\t\t.then((data) => {\n\t\t\t\tresolve(\n\t\t\t\t\tdata\n\t\t\t\t\t\t? { source: src, arrayBuffer: data, orientation: getOrientation(data) }\n\t\t\t\t\t\t: { source: src, arrayBuffer: null, orientation: null },\n\t\t\t\t);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.warn(error);\n\t\t\t\tresolve({ source: src, arrayBuffer: null, orientation: null });\n\t\t\t});\n\t});\n}\n\nexport function arrayBufferToDataURL(arrayBuffer) {\n\tconst chunks = [];\n\n\t// Chunk Typed Array for better performance\n\tconst chunkSize = 8192;\n\tlet uint8 = new Uint8Array(arrayBuffer);\n\n\twhile (uint8.length > 0) {\n\t\tconst value = uint8.subarray(0, chunkSize);\n\t\tchunks.push(String.fromCharCode.apply(null, Array.from ? Array.from(value) : value.slice()));\n\t\tuint8 = uint8.subarray(chunkSize);\n\t}\n\n\treturn `data:image/jpeg;base64,${btoa(chunks.join(''))}`;\n}\n","import { distance } from './utils';\r\n\r\nexport function calculateGeometricProperties(touches: Touch[], container: HTMLElement) {\r\n\tconst { left, top } = container.getBoundingClientRect();\r\n\r\n\tconst centerMass = { left: 0, top: 0 };\r\n\tlet spread = 0;\r\n\r\n\ttouches.forEach((touch) => {\r\n\t\tcenterMass.left += (touch.clientX - left) / touches.length;\r\n\t\tcenterMass.top += (touch.clientY - top) / touches.length;\r\n\t});\r\n\r\n\ttouches.forEach((touch) => {\r\n\t\tspread += distance(\r\n\t\t\t{ x: centerMass.left, y: centerMass.top },\r\n\t\t\t{ x: touch.clientX - left, y: touch.clientY - top },\r\n\t\t);\r\n\t});\r\n\r\n\treturn { centerMass, spread, count: touches.length };\r\n}\r\n","import Vue from 'vue';\r\nimport Cropper from './Cropper.vue';\r\n\r\nimport { RectangleStencil, CircleStencil } from './components/stencils';\r\n\r\nimport { SimpleHandler } from './components/handlers';\r\n\r\nimport { SimpleLine } from './components/lines';\r\n\r\nexport {\r\n\tPreviewResult,\r\n\tDraggableArea,\r\n\tBoundingBox,\r\n\tLineWrapper,\r\n\tHandlerWrapper,\r\n\tDraggableElement,\r\n} from './components/service';\r\n\r\nexport { RectangleStencil, CircleStencil } from './components/stencils';\r\n\r\nexport { SimpleHandler } from './components/handlers';\r\n\r\nexport { SimpleLine } from './components/lines';\r\n\r\nexport { PreviewImage } from './components/helpers';\r\n\r\nexport { ResizeEvent, MoveEvent, DragEvent } from './core/events';\r\n\r\nexport { default as Cropper } from './Cropper.vue';\r\n\r\nVue.component('cropper', Cropper);\r\nVue.component('rectangle-stencil', RectangleStencil);\r\nVue.component('circle-stencil', CircleStencil);\r\nVue.component('simple-handler', SimpleHandler);\r\nVue.component('simple-line', SimpleLine);\r\n"],"names":["classNames","arg","classes","i","arguments","length","argType","push","Array","isArray","inner","apply","key","hasOwn","call","join","hasOwnProperty","module","exports","default","window","componentName","elementOrMods","mods","element","base","Object","keys","reduce","result","name","value","debounce","func","wait","immediate","later","last","Date","now","timestamp","timeout","setTimeout","context","args","debounced","callNow","clear","clearTimeout","flush","__assign","assign","t","s","n","p","prototype","move","scale","type","directions","params","nativeEvent","position","previousPosition","anchor","DragEvent","_a","_b","getBoundingClientRect","left","top","ALL_DIRECTIONS","HORIZONTAL_DIRECTIONS","VERTICAL_DIRECTIONS","MAIN_DIRECTIONS","IMAGE_RESTRICTIONS","DEFAULT_COORDINATES","width","height","toLimits","object","right","bottom","diff","firstObject","secondObject","getCenter","getIntersections","limits","Math","max","intersections","forEach","direction","areaLimit","objectLimit","applyDirections","coordinates","inverseMove","applyMove","applyScale","scaleFactor","center","progress","currentCenter","ratio","maxScale","area","min","fit","intersection","getBrokenRatio","currentAspectRatio","aspectRatio","ratioBroken","minimum","maximum","fitSize","firstSize","secondSize","firstRatio","secondRatio","rotateSize","size","angle","sin","abs","cos","radians","PI","rotatePoint","point","adjustSize","fitToLimits","inverse","limitsToSize","limitSizeRestrictions","sizeRestrictions","minWidth","minHeight","maxWidth","maxHeight","joinLimits","a","b","firstDirection","secondDirection","intersectionLimits","validateSize","ignoreMinimum","correctRatio","distance","pow","approximatedSize","findBestCandidate","candidates","candidate","directionNames","hDirection","vDirection","classname","toUpperCase","slice","isLocal","url","test","isCrossOriginURL","pageLocation","location","urlMatch","exec","urlparts","protocol","host","port","defaultPort","portOf","isFunction","obj","constructor","isUndefined","isObject","getOptions","options","defaultScheme","falseScheme","getSettings","param","defaultParams","enabled","parseNumber","number","Number","isNaN","parsedNumber","replacedProp","oldName","currentName","isEmpty","console","warn","isObjectLike","isNumber","toString","isLoadedImage","image","naturalWidth","firstPoint","secondPoint","sqrt","x","y","isApproximatelyEqual","precision","sign","event","positionRestrictions","movedCoordinates","applyTransform","initialCoordinates","transform","imageSize","moveAlgorithm","prevCoordinates","newCoordinates","MoveEvent","resizeAlgorithm","transforms","changes","dynamicAreaRestrictions","visibleArea","boundaries","imageRestriction","fixedStencilAutoZoom","getAreaRestrictions","originalCoordinates","originalVisibleArea","stencilSize","stencilReference","stencil","error","hybridStencilAutoZoom","coefficient","simplestAutoZoom","widthIntersections","heightIntersections","fitBoundaries","cropper","areaHeight","clientHeight","areaWidth","clientWidth","currentHeight","currentWidth","fillBoundaries","defaultPosition","defaultSize","optimalRatio","fixedDefaultSize","defaultVisibleArea","boundaryRatio","reference","areaProperties","coordinatesIntersection","imageRatio","fitCoordinates","previousCoordinates","initStretcher","stretcher","style","limitBy","manipulateImage","adjustStencil","areaScale","stencilScale","allowedScale","factor","scaleRestrictions","relativeCoordinates","rotateImage","previousImageSize","imageCenter","flipImage","flip","previousFlip","rotate","changed","horizontal","vertical","oldCenter","newCenter","normalizeEvent","normalizedEvent_1","normalizedEvent_2","percentRestrictions","refineSizeRestrictions","restrictions","areaMaximum","widthFrozen","heightFrozen","refineVisibleArea","previousVisibleArea","boundariesRatio","fitConditions","preserveRatio","compensate","fittedDirections","breaks","maxResize","multiplier_1","map","multiplier_2","distributeOverlap","overlap","first","second","resize","actualCoordinates","eventParams","allowedDirections","respectDirection","overlapHeight","top_1","overlapWidth","roundCoordinates","ceil","floor","round","roundedCoordinates","fitVisibleArea","calculateStencilSize","beforeMount","addEventListener","onMouseUp","passive","onMouseMove","onTouchMove","onTouchEnd","beforeDestroy","removeEventListener","mounted","$refs","draggable","Error","touches","hovered","methods","onMouseOver","$emit","onMouseLeave","onTouchStart","e","cancelable","disabled","initAnchor","mean","touch","clientX","clientY","preventDefault","stopPropagation","processEnd","processMove","onMouseDown","fake","newTouches","normalizeComponent","template","script","scopeId","isFunctionalTemplate","moduleIdentifier","shadowMode","createInjector","createInjectorSSR","createInjectorShadow","render","staticRenderFns","_compiled","functional","_scopeId","hook","$vnode","ssrContext","parent","__VUE_SSR_CONTEXT__","_registeredComponents","add","_ssrRegister","$root","$options","shadowRoot","originalRender","h","existing","beforeCreate","concat","updateCanvas","canvas","source","resultCoordinates","ctx","getContext","clearRect","drawImage","XHR_DONE","prepareSource","originalSize","naturalHeight","transformedSize","save","canvasCenter","translate","restore","base64ToArrayBuffer","base64","replace","binary","atob","len","buffer","ArrayBuffer","view","Uint8Array","charCodeAt","objectURLToBlob","callback","http","XMLHttpRequest","open","responseType","onload","status","response","send","getImageTransforms","orientation","getImageData","img","Promise","resolve","reject","fileReader_1","FileReader","target","blob","readAsArrayBuffer","http_1","onreadystatechange","readyState","onprogress","getResponseHeader","abort","withCredentials","getStyleTransforms","getStringFromCharCode","dataView","start","str","String","fromCharCode","getUint8","getOrientation","arrayBuffer","orientation_1","DataView","exifIDCode","tiffOffset","littleEndian","app1Start","ifdStart","length_1","byteLength","offset","endianness","getUint16","firstIFDOffset","getUint32","length_2","setUint16","parseImage","src","then","data","catch","arrayBufferToDataURL","chunks","chunkSize","uint8","subarray","from","btoa","calculateGeometricProperties","container","centerMass","spread","count","Vue","component","Cropper","RectangleStencil","CircleStencil","SimpleHandler","SimpleLine"],"mappings":"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"}